# POSX ç³»ç»Ÿè§„èŒƒæ–‡æ¡£ v1.0

**æ–‡æ¡£ç±»å‹ï¼š** ç³»ç»Ÿæ¶æ„ä¸ä¸šåŠ¡è§„èŒƒ  
**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0.0  
**å‘å¸ƒæ—¥æœŸï¼š** 2025-11-07  
**æ–‡æ¡£çŠ¶æ€ï¼š** æ­£å¼å‘å¸ƒ âœ…  
**é€‚ç”¨èŒƒå›´ï¼š** å…¨ç³»ç»Ÿï¼ˆBackend + Frontend + Infrastructureï¼‰

---

## ğŸ“‹ ç›®å½•

1. [æ–‡æ¡£æ¦‚è¿°](#1-æ–‡æ¡£æ¦‚è¿°)
2. [ç³»ç»Ÿæ¦‚è¿°](#2-ç³»ç»Ÿæ¦‚è¿°)
3. [æ ¸å¿ƒä¸šåŠ¡è§„åˆ™](#3-æ ¸å¿ƒä¸šåŠ¡è§„åˆ™)
4. [æŠ€æœ¯æ¶æ„è§„åˆ™](#4-æŠ€æœ¯æ¶æ„è§„åˆ™)
5. [æ•°æ®æ¨¡å‹è§„èŒƒ](#5-æ•°æ®æ¨¡å‹è§„èŒƒ)
6. [API è®¾è®¡è§„èŒƒ](#6-api-è®¾è®¡è§„èŒƒ)
7. [è®¤è¯ä¸æˆæƒè§„èŒƒ](#7-è®¤è¯ä¸æˆæƒè§„èŒƒ)
8. [æ”¯ä»˜ä¸è®¢å•è§„èŒƒ](#8-æ”¯ä»˜ä¸è®¢å•è§„èŒƒ)
9. [ä»£å¸åˆ†é…è§„èŒƒ](#9-ä»£å¸åˆ†é…è§„èŒƒ)
10. [ä½£é‡‘ç³»ç»Ÿè§„èŒƒ](#10-ä½£é‡‘ç³»ç»Ÿè§„èŒƒ)
11. [å®‰å…¨è§„èŒƒ](#11-å®‰å…¨è§„èŒƒ)
12. [ç¯å¢ƒé…ç½®è§„èŒƒ](#12-ç¯å¢ƒé…ç½®è§„èŒƒ)
13. [éƒ¨ç½²è§„èŒƒ](#13-éƒ¨ç½²è§„èŒƒ)
14. [è¿ç»´è§„èŒƒ](#14-è¿ç»´è§„èŒƒ)
15. [ç›‘æ§ä¸å‘Šè­¦è§„èŒƒ](#15-ç›‘æ§ä¸å‘Šè­¦è§„èŒƒ)
16. [æœ¯è¯­è¡¨](#16-æœ¯è¯­è¡¨)

---

## 1. æ–‡æ¡£æ¦‚è¿°

### 1.1 æ–‡æ¡£ç›®çš„

æœ¬æ–‡æ¡£å®šä¹‰ POSX ä»£å¸é¢„å”®å¹³å°çš„å®Œæ•´ç³»ç»Ÿè§„èŒƒï¼ŒåŒ…æ‹¬ä¸šåŠ¡è§„åˆ™ã€æŠ€æœ¯æ¶æ„ã€æ•°æ®æ¨¡å‹ã€API è®¾è®¡ã€å®‰å…¨ç­–ç•¥å’Œè¿ç»´è§„èŒƒã€‚

### 1.2 ç›®æ ‡è¯»è€…

- å¼€å‘å·¥ç¨‹å¸ˆï¼ˆBackend/Frontendï¼‰
- ç³»ç»Ÿæ¶æ„å¸ˆ
- DevOps å·¥ç¨‹å¸ˆ
- äº§å“ç»ç†
- AI è¾…åŠ©å¼€å‘ç³»ç»Ÿ

### 1.3 æ–‡æ¡£çº¦å®š

```yaml
è§„èŒƒçº§åˆ«:
  MUST: å¿…é¡»éµå®ˆï¼ˆå¼ºåˆ¶æ€§ï¼‰
  SHOULD: åº”è¯¥éµå®ˆï¼ˆæ¨èï¼‰
  MAY: å¯ä»¥é€‰æ‹©ï¼ˆå¯é€‰ï¼‰
  MUST_NOT: ç¦æ­¢ï¼ˆä¸¥æ ¼ç¦æ­¢ï¼‰

å˜æ›´ç®¡ç†:
  - é‡å¤§å˜æ›´éœ€è¦æ¶æ„è¯„å®¡
  - æ‰€æœ‰å˜æ›´éœ€è¦ç‰ˆæœ¬å·é€’å¢
  - ç ´åæ€§å˜æ›´éœ€è¦è¿ç§»è®¡åˆ’
```

### 1.4 ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | å˜æ›´å†…å®¹ | ä½œè€… |
|------|------|---------|------|
| v1.0.0 | 2025-11-07 | åˆå§‹æ­£å¼ç‰ˆæœ¬ | System Architect |

---

## 2. ç³»ç»Ÿæ¦‚è¿°

### 2.1 ç³»ç»Ÿç®€ä»‹

POSX æ˜¯ä¸€ä¸ªå¤šç«™ç‚¹ã€å¤šå¸ç§çš„ä»£å¸é¢„å”®å¹³å°ï¼Œæ”¯æŒï¼š
- ç”¨æˆ·æ³¨å†Œä¸ KYC
- å¤šæ¡£ä½ä»£å¸è´­ä¹°
- å¤šå±‚çº§æ¨èä½£é‡‘
- ä»£å¸é”ä»“ä¸é‡Šæ”¾
- å¤šç«™ç‚¹ç‹¬ç«‹è¿è¥

### 2.2 ç³»ç»Ÿè¾¹ç•Œ

```yaml
ç³»ç»ŸèŒƒå›´:
  - Web åº”ç”¨ï¼ˆç”¨æˆ·ç«¯ï¼‰
  - Admin åå°ï¼ˆç®¡ç†ç«¯ï¼‰
  - RESTful APIï¼ˆåç«¯æœåŠ¡ï¼‰
  - Webhook å¤„ç†ï¼ˆç¬¬ä¸‰æ–¹é›†æˆï¼‰
  - å®šæ—¶ä»»åŠ¡ï¼ˆåå°ä»»åŠ¡ï¼‰

å¤–éƒ¨ä¾èµ–:
  - Auth0: ç”¨æˆ·è®¤è¯
  - Stripe: æ”¯ä»˜å¤„ç†
  - Fireblocks: ä»£å¸æ‰˜ç®¡ä¸åˆ†å‘
  - WalletConnect: Web3 é’±åŒ…è¿æ¥
  - PostgreSQL: ä¸»æ•°æ®åº“
  - Redis: ç¼“å­˜ä¸é˜Ÿåˆ—
  - Celery: å¼‚æ­¥ä»»åŠ¡
```

### 2.3 æ ¸å¿ƒèƒ½åŠ›

```yaml
ç”¨æˆ·èƒ½åŠ›:
  - å¤šç§æ–¹å¼æ³¨å†Œç™»å½•ï¼ˆEmail/Passkey/Walletï¼‰
  - æµè§ˆæ¡£ä½ä¿¡æ¯
  - è´­ä¹°ä»£å¸ï¼ˆStripe æ”¯ä»˜ï¼‰
  - æŸ¥çœ‹è®¢å•å†å²
  - æŸ¥çœ‹ä»£å¸ä½™é¢ï¼ˆæ€»é‡/é”ä»“/å¯ç”¨ï¼‰
  - æ¨èæ–°ç”¨æˆ·è·å¾—ä½£é‡‘

ç®¡ç†å‘˜èƒ½åŠ›:
  - ç«™ç‚¹ç®¡ç†
  - æ¡£ä½é…ç½®
  - è®¢å•ç®¡ç†
  - æ‰‹åŠ¨å‘æ”¾ä»£å¸ï¼ˆé€šè¿‡ Fireblocksï¼‰
  - ä½£é‡‘é…ç½®ä¸ç»“ç®—
  - ç”¨æˆ·ç®¡ç†
  - æ•°æ®åˆ†æ

ç³»ç»Ÿèƒ½åŠ›:
  - é«˜å¹¶å‘è®¢å•å¤„ç†
  - å¹‚ç­‰æ€§ä¿è¯
  - åº“å­˜ç²¾ç¡®æ§åˆ¶
  - å¤šå±‚çº§ä½£é‡‘è®¡ç®—
  - å®šæ—¶ä»»åŠ¡æ‰§è¡Œ
  - ç›‘æ§ä¸å‘Šè­¦
```

---

## 3. æ ¸å¿ƒä¸šåŠ¡è§„åˆ™

### 3.1 ä¸šåŠ¡åŸåˆ™

```yaml
åŸåˆ™ 1: æ— é€€æ¬¾æ”¿ç­–
  è§„åˆ™:
    - MUST_NOT æ”¯æŒè®¢å•é€€æ¬¾
    - MUST_NOT æ”¯æŒè®¢å•å–æ¶ˆï¼ˆæ”¯ä»˜åï¼‰
    - MUST ç›‘æ§é“¶è¡Œæ‹’ä»˜ï¼ˆdisputeï¼‰
    - MUST è®°å½•äº‰è®®ä¿¡æ¯ï¼ˆä¸æ”¹è®¢å•çŠ¶æ€ï¼‰
  
  ç†ç”±:
    - ä»£å¸é¢„å”®ç‰¹æ€§
    - ç®€åŒ–è´¢åŠ¡æµç¨‹
    - é“¶è¡Œæ‹’ä»˜ä»éœ€ç›‘æ§

åŸåˆ™ 2: æ‰‹åŠ¨å‘å¸
  è§„åˆ™:
    - MUST_NOT è‡ªåŠ¨å‘æ”¾ä»£å¸
    - MUST ç”±ç®¡ç†å‘˜æ‰‹åŠ¨æ“ä½œ
    - MUST é€šè¿‡ Fireblocks API
    - MUST è®°å½•æ‰€æœ‰å‘æ”¾çŠ¶æ€
  
  ç†ç”±:
    - åˆè§„è¦æ±‚
    - é£æ§éœ€è¦
    - å¯å®¡è®¡æ€§

åŸåˆ™ 3: é’±åŒ…åœ°å€å¿…å¡«
  è§„åˆ™:
    - MUST åœ¨æ”¯ä»˜å‰å¡«å†™é’±åŒ…åœ°å€
    - MUST éªŒè¯é’±åŒ…åœ°å€æ ¼å¼
    - MUST ç»Ÿä¸€ä½¿ç”¨å°å†™å­˜å‚¨
    - MUST_NOT å…è®¸é‡å¤ç»‘å®š
  
  ç†ç”±:
    - ä»£å¸æ¥æ”¶å¿…éœ€
    - é¿å…å‘æ”¾é”™è¯¯

åŸåˆ™ 4: æ•°æ®ä¸€è‡´æ€§
  è§„åˆ™:
    - MUST ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡
    - MUST å®ç°å¹‚ç­‰æ€§
    - MUST ä½¿ç”¨ä¹è§‚é”æ§åˆ¶åº“å­˜
    - MUST è®°å½•æ‰€æœ‰çŠ¶æ€å˜æ›´
  
  ç†ç”±:
    - é¿å…è¶…å–
    - ä¿è¯æ•°æ®å‡†ç¡®

åŸåˆ™ 5: å¤šç«™ç‚¹éš”ç¦»
  è§„åˆ™:
    - MUST æŒ‰ç«™ç‚¹éš”ç¦»æ•°æ®
    - MUST ç‹¬ç«‹çš„æ¡£ä½é…ç½®
    - MUST ç‹¬ç«‹çš„ä½£é‡‘é…ç½®
    - SHOULD å…±äº«ç”¨æˆ·ä½“ç³»
  
  ç†ç”±:
    - ä¸åŒåœ°åŒºè¿è¥
    - åˆè§„è¦æ±‚
```

### 3.2 è®¢å•ç”Ÿå‘½å‘¨æœŸ

```yaml
è®¢å•çŠ¶æ€å®šä¹‰:
  pending:
    æè¿°: å¾…æ”¯ä»˜
    å¯è½¬æ¢è‡³: [paid, failed, cancelled]
    è¶…æ—¶: 15 åˆ†é’Ÿ
  
  paid:
    æè¿°: å·²æ”¯ä»˜
    å¯è½¬æ¢è‡³: []
    ç»ˆæ€: true
  
  failed:
    æè¿°: æ”¯ä»˜å¤±è´¥
    å¯è½¬æ¢è‡³: []
    ç»ˆæ€: true
  
  cancelled:
    æè¿°: å·²å–æ¶ˆï¼ˆè¶…æ—¶ï¼‰
    å¯è½¬æ¢è‡³: []
    ç»ˆæ€: true

çŠ¶æ€è½¬æ¢è§„åˆ™:
  pending â†’ paid:
    è§¦å‘: Stripe payment_intent.succeeded
    åŠ¨ä½œ:
      - æ›´æ–°è®¢å•çŠ¶æ€
      - è®°å½• paid_at
      - ç”Ÿæˆå¤šå±‚çº§ä½£é‡‘
      - åˆ›å»ºåˆ†é…è®°å½•ï¼ˆstatus=pendingï¼‰
  
  pending â†’ failed:
    è§¦å‘: Stripe payment_intent.payment_failed
    åŠ¨ä½œ:
      - æ›´æ–°è®¢å•çŠ¶æ€
      - è®°å½•å¤±è´¥åŸå› 
      - é‡Šæ”¾åº“å­˜
  
  pending â†’ cancelled:
    è§¦å‘: è¶…æ—¶ 15 åˆ†é’Ÿ
    åŠ¨ä½œ:
      - æ›´æ–°è®¢å•çŠ¶æ€
      - è®°å½• cancelled_at
      - é‡Šæ”¾åº“å­˜

è®¢å•çº¦æŸ:
  - MUST åŒ…å«é’±åŒ…åœ°å€
  - MUST åŒ…å«å¹‚ç­‰é”®
  - MUST å…³è”ç«™ç‚¹
  - MUST è®°å½•ä»·æ ¼å¿«ç…§
  - MAY å…³è”æ¨èäºº
```

### 3.3 ä»£å¸åˆ†é…ç”Ÿå‘½å‘¨æœŸ

```yaml
åˆ†é…çŠ¶æ€å®šä¹‰:
  pending:
    æè¿°: ç­‰å¾…å‘æ”¾
    å¯è½¬æ¢è‡³: [processing]
    è§¦å‘: è®¢å•æ”¯ä»˜æˆåŠŸè‡ªåŠ¨åˆ›å»º
  
  processing:
    æè¿°: å‘æ”¾ä¸­
    å¯è½¬æ¢è‡³: [completed, failed]
    è§¦å‘: ç®¡ç†å‘˜ç‚¹å‡»"å‘æ”¾"
  
  completed:
    æè¿°: å·²å®Œæˆ
    å¯è½¬æ¢è‡³: []
    ç»ˆæ€: true
  
  failed:
    æè¿°: å‘æ”¾å¤±è´¥
    å¯è½¬æ¢è‡³: [pending]
    å¯é‡è¯•: true

åˆ†é…è§„åˆ™:
  - MUST ä¸€ä¸ªè®¢å•ä¸€æ¡åˆ†é…è®°å½•
  - MUST è®°å½• Fireblocks äº¤æ˜“ ID
  - MUST è®°å½•é“¾ä¸Šäº¤æ˜“å“ˆå¸Œ
  - MUST æ”¯æŒå¤±è´¥é‡è¯•
  - MUST æ‰¹é‡å‘æ”¾æœ€å¤š 100 ç¬”
```

### 3.4 ä½£é‡‘ç”Ÿå‘½å‘¨æœŸ

```yaml
ä½£é‡‘çŠ¶æ€å®šä¹‰:
  hold:
    æè¿°: å†»ç»“æœŸ
    å¯è½¬æ¢è‡³: [ready, cancelled]
    æœŸé™: å¯é…ç½®ï¼ˆé»˜è®¤ 7 å¤©ï¼‰
  
  ready:
    æè¿°: å¯ç»“ç®—
    å¯è½¬æ¢è‡³: [paid, cancelled]
    è§¦å‘: å†»ç»“æœŸç»“æŸ
  
  paid:
    æè¿°: å·²ç»“ç®—
    å¯è½¬æ¢è‡³: []
    ç»ˆæ€: true
  
  cancelled:
    æè¿°: å·²å–æ¶ˆ
    å¯è½¬æ¢è‡³: []
    ç»ˆæ€: true

ä½£é‡‘è§„åˆ™:
  - MUST æ”¯æŒå¤šå±‚çº§ï¼ˆé»˜è®¤ 2 å±‚ï¼‰
  - MUST å¯æŒ‰ç«™ç‚¹é…ç½®
  - MUST å¯æŒ‰ä»£ç†è‡ªå®šä¹‰
  - MUST è®°å½•ä½£é‡‘æ¥æºï¼ˆè®¢å•/å±‚çº§ï¼‰
  - MUST æ”¯æŒå†»ç»“æœŸ
  - MUST ä½¿ç”¨å”¯ä¸€çº¦æŸé˜²é‡å¤
```

---

## 4. æŠ€æœ¯æ¶æ„è§„åˆ™

### 4.1 æ¶æ„åŸåˆ™

```yaml
åŸåˆ™ 1: å¾®æœåŠ¡ä¼˜å…ˆ
  - SHOULD æŒ‰ä¸šåŠ¡åŸŸæ‹†åˆ†æœåŠ¡
  - MUST æœåŠ¡é—´é€šè¿‡ API é€šä¿¡
  - MUST é¿å…ç›´æ¥æ•°æ®åº“è®¿é—®

åŸåˆ™ 2: æ— çŠ¶æ€è®¾è®¡
  - MUST API æ— çŠ¶æ€
  - MUST Session å­˜å‚¨åœ¨ Redis
  - MUST æ”¯æŒæ°´å¹³æ‰©å±•

åŸåˆ™ 3: å¼‚æ­¥ä¼˜å…ˆ
  - SHOULD é•¿æ—¶é—´ä»»åŠ¡å¼‚æ­¥æ‰§è¡Œ
  - MUST Webhook å¤„ç†å¼‚æ­¥
  - MUST ä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—è§£è€¦

åŸåˆ™ 4: å®¹é”™è®¾è®¡
  - MUST å®ç°é‡è¯•æœºåˆ¶
  - MUST å®ç°ç†”æ–­æœºåˆ¶
  - MUST å®ç°é™çº§ç­–ç•¥
  - MUST è®°å½•æ‰€æœ‰é”™è¯¯
```

### 4.2 æŠ€æœ¯æ ˆè§„èŒƒ

```yaml
åç«¯æŠ€æœ¯æ ˆ:
  è¯­è¨€: Python 3.11+
  æ¡†æ¶: Django 4.2+ / Django REST Framework
  æ•°æ®åº“: PostgreSQL 15+
  ç¼“å­˜: Redis 7+
  ä»»åŠ¡é˜Ÿåˆ—: Celery + Redis
  Web æœåŠ¡å™¨: Gunicorn + Nginx
  
å‰ç«¯æŠ€æœ¯æ ˆ:
  æ¡†æ¶: Next.js 14+ (App Router)
  è¯­è¨€: TypeScript 5+
  çŠ¶æ€ç®¡ç†: React Context / Zustand
  UI åº“: Tailwind CSS + shadcn/ui
  é’±åŒ…é›†æˆ: @web3modal/wagmi

ç¬¬ä¸‰æ–¹æœåŠ¡:
  è®¤è¯: Auth0
  æ”¯ä»˜: Stripe
  ä»£å¸æ‰˜ç®¡: Fireblocks
  é’±åŒ…è¿æ¥: WalletConnect
  ç›‘æ§: Sentry
  æ—¥å¿—: CloudWatch / ELK
```

### 4.3 ä»£ç ç»„ç»‡è§„èŒƒ

```yaml
åç«¯ç›®å½•ç»“æ„:
  posx-backend/
    â”œâ”€â”€ apps/                    # åº”ç”¨æ¨¡å—
    â”‚   â”œâ”€â”€ users/              # ç”¨æˆ·æ¨¡å—
    â”‚   â”œâ”€â”€ sites/              # ç«™ç‚¹æ¨¡å—
    â”‚   â”œâ”€â”€ tiers/              # æ¡£ä½æ¨¡å—
    â”‚   â”œâ”€â”€ orders/             # è®¢å•æ¨¡å—
    â”‚   â”œâ”€â”€ allocations/        # åˆ†é…æ¨¡å—
    â”‚   â”œâ”€â”€ commissions/        # ä½£é‡‘æ¨¡å—
    â”‚   â”œâ”€â”€ webhooks/           # Webhook æ¨¡å—
    â”‚   â””â”€â”€ core/               # æ ¸å¿ƒæ¨¡å—
    â”œâ”€â”€ config/                 # é…ç½®
    â”‚   â”œâ”€â”€ settings/           # Django é…ç½®
    â”‚   â”œâ”€â”€ celery.py          # Celery é…ç½®
    â”‚   â””â”€â”€ urls.py            # URL è·¯ç”±
    â”œâ”€â”€ middleware/             # ä¸­é—´ä»¶
    â”œâ”€â”€ utils/                  # å·¥å…·å‡½æ•°
    â”œâ”€â”€ tests/                  # æµ‹è¯•
    â””â”€â”€ manage.py

å‰ç«¯ç›®å½•ç»“æ„:
  posx-frontend/
    â”œâ”€â”€ app/                    # Next.js App Router
    â”‚   â”œâ”€â”€ (auth)/            # è®¤è¯ç›¸å…³é¡µé¢
    â”‚   â”œâ”€â”€ (dashboard)/       # ç”¨æˆ·ä»ªè¡¨æ¿
    â”‚   â”œâ”€â”€ (admin)/           # ç®¡ç†åå°
    â”‚   â””â”€â”€ api/               # API è·¯ç”±
    â”œâ”€â”€ components/             # ç»„ä»¶
    â”‚   â”œâ”€â”€ ui/                # åŸºç¡€ UI ç»„ä»¶
    â”‚   â”œâ”€â”€ forms/             # è¡¨å•ç»„ä»¶
    â”‚   â””â”€â”€ features/          # åŠŸèƒ½ç»„ä»¶
    â”œâ”€â”€ lib/                    # å·¥å…·åº“
    â”‚   â”œâ”€â”€ api/               # API å®¢æˆ·ç«¯
    â”‚   â”œâ”€â”€ auth/              # è®¤è¯é€»è¾‘
    â”‚   â””â”€â”€ wallet/            # é’±åŒ…é€»è¾‘
    â”œâ”€â”€ hooks/                  # React Hooks
    â”œâ”€â”€ types/                  # TypeScript ç±»å‹
    â””â”€â”€ public/                 # é™æ€èµ„æº

æ¨¡å—åˆ’åˆ†åŸåˆ™:
  - MUST æŒ‰ä¸šåŠ¡åŸŸåˆ’åˆ†æ¨¡å—
  - MUST æ¨¡å—é—´ä½è€¦åˆ
  - SHOULD æ¨¡å—å†…é«˜å†…èš
  - MUST é¿å…å¾ªç¯ä¾èµ–
```

### 4.4 æ•°æ®åº“æ¶æ„è§„èŒƒ

```yaml
æ•°æ®åº“é€‰æ‹©:
  ä¸»åº“: PostgreSQL 15+
  ç†ç”±:
    - ACID äº‹åŠ¡æ”¯æŒ
    - ä¸°å¯Œçš„æ•°æ®ç±»å‹
    - å¼ºå¤§çš„ç´¢å¼•èƒ½åŠ›
    - JSON æ”¯æŒ

è¡¨è®¾è®¡åŸåˆ™:
  - MUST ä½¿ç”¨ UUID ä½œä¸ºä¸»é”®
  - MUST æ‰€æœ‰è¡¨åŒ…å« created_at
  - SHOULD æ‰€æœ‰è¡¨åŒ…å« updated_at
  - MUST ä½¿ç”¨ TIMESTAMPTZ å­˜å‚¨æ—¶é—´
  - MUST é‡‘é¢ä½¿ç”¨ NUMERIC(18, 6)
  - MUST å¤–é”®ä½¿ç”¨ ON DELETE ç­–ç•¥

ç´¢å¼•è§„èŒƒ:
  - MUST ä¸»é”®è‡ªåŠ¨ç´¢å¼•
  - MUST å¤–é”®åˆ›å»ºç´¢å¼•
  - MUST æŸ¥è¯¢æ¡ä»¶å­—æ®µåˆ›å»ºç´¢å¼•
  - SHOULD å¤åˆç´¢å¼•ä¼˜å…ˆäºå•åˆ—ç´¢å¼•
  - MUST å®šæœŸåˆ†æç´¢å¼•ä½¿ç”¨ç‡

çº¦æŸè§„èŒƒ:
  - MUST ä½¿ç”¨ UNIQUE çº¦æŸé˜²é‡
  - MUST ä½¿ç”¨ CHECK çº¦æŸéªŒè¯æ•°æ®
  - MUST ä½¿ç”¨ NOT NULL çº¦æŸå¿…å¡«å­—æ®µ
  - SHOULD ä½¿ç”¨è§¦å‘å™¨åŒæ­¥å†—ä½™å­—æ®µ
```

---

## 5. æ•°æ®æ¨¡å‹è§„èŒƒ

### 5.1 æ ¸å¿ƒå®ä½“å®šä¹‰

```yaml
Userï¼ˆç”¨æˆ·ï¼‰:
  ä¸»é”®: user_id (UUID)
  å”¯ä¸€é”®:
    - auth0_sub
    - wallet_address
    - email
    - referral_code
  ç´¢å¼•:
    - referrer_id
    - primary_wallet_id
  å¿…å¡«å­—æ®µ:
    - user_id
    - auth_type
    - referral_code
    - created_at
  å¯é€‰å­—æ®µ:
    - auth0_sub (auth_type=auth0 æ—¶å¿…å¡«)
    - wallet_address (auth_type=wallet æ—¶å¿…å¡«)
    - email
    - primary_wallet_id
    - is_agent
    - stripe_account_id

Walletï¼ˆé’±åŒ…ï¼‰:
  ä¸»é”®: wallet_id (UUID)
  å”¯ä¸€é”®:
    - (user_id, address)
    - LOWER(address)
  ç´¢å¼•:
    - user_id
    - address
    - LOWER(address)
  çº¦æŸ:
    - address æ ¼å¼: ^0x[a-fA-F0-9]{40}$
    - æ¯ä¸ªç”¨æˆ·æœ€å¤šä¸€ä¸ªä¸»é’±åŒ…
  å¿…å¡«å­—æ®µ:
    - wallet_id
    - user_id
    - address
    - created_at

Siteï¼ˆç«™ç‚¹ï¼‰:
  ä¸»é”®: site_id (UUID)
  å”¯ä¸€é”®: code
  å¿…å¡«å­—æ®µ:
    - site_id
    - code
    - name
    - currency_code
    - is_active
    - created_at

Tierï¼ˆæ¡£ä½ï¼‰:
  ä¸»é”®: tier_id (UUID)
  ç´¢å¼•:
    - site_id
    - (site_id, display_order)
  å¿…å¡«å­—æ®µ:
    - tier_id
    - site_id
    - name
    - list_price_usd
    - tokens_per_unit
    - total_units
    - sold_units
    - available_units
    - version (ä¹è§‚é”)
    - is_active
    - created_at

Orderï¼ˆè®¢å•ï¼‰:
  ä¸»é”®: order_id (UUID)
  å”¯ä¸€é”®:
    - stripe_payment_intent_id
    - idempotency_key
  ç´¢å¼•:
    - buyer_id
    - site_id
    - referrer_id
    - status
    - created_at
    - disputed
  å¿…å¡«å­—æ®µ:
    - order_id
    - buyer_id
    - site_id
    - status
    - list_price_usd
    - final_price_usd
    - wallet_address
    - created_at

Allocationï¼ˆåˆ†é…ï¼‰:
  ä¸»é”®: allocation_id (UUID)
  å”¯ä¸€é”®: order_id
  ç´¢å¼•:
    - order_id
    - status
    - fireblocks_tx_id
  å¿…å¡«å­—æ®µ:
    - allocation_id
    - order_id
    - wallet_address
    - token_amount
    - status
    - created_at

Commissionï¼ˆä½£é‡‘ï¼‰:
  ä¸»é”®: commission_id (UUID)
  å”¯ä¸€é”®: (order_id, agent_id, level)
  ç´¢å¼•:
    - order_id
    - agent_id
    - status
  å¿…å¡«å­—æ®µ:
    - commission_id
    - order_id
    - agent_id
    - level
    - rate_percent
    - commission_amount_usd
    - status
    - hold_until
    - created_at
```

### 5.2 æ•°æ®å®Œæ•´æ€§è§„åˆ™

```yaml
å¤–é”®ç­–ç•¥:
  ç”¨æˆ·åˆ é™¤:
    - orders.buyer_id: ON DELETE PROTECT (ç¦æ­¢åˆ é™¤æœ‰è®¢å•çš„ç”¨æˆ·)
    - commissions.agent_id: ON DELETE PROTECT
    - wallets.user_id: ON DELETE CASCADE
  
  ç«™ç‚¹åˆ é™¤:
    - tiers.site_id: ON DELETE PROTECT
    - orders.site_id: ON DELETE PROTECT
  
  è®¢å•åˆ é™¤:
    - allocations.order_id: ON DELETE CASCADE
    - commissions.order_id: ON DELETE CASCADE

å”¯ä¸€æ€§çº¦æŸ:
  - users.auth0_sub
  - users.wallet_address
  - users.email
  - users.referral_code
  - wallets.address (LOWER)
  - sites.code
  - tiers.tier_id
  - orders.stripe_payment_intent_id
  - orders.idempotency_key
  - allocations.order_id
  - commissions.(order_id, agent_id, level)
  - webhooks.(source, external_event_id)
  - nonces.nonce

æ£€æŸ¥çº¦æŸ:
  - users.auth_type IN ('auth0', 'wallet')
  - orders.status IN ('pending', 'paid', 'failed', 'cancelled')
  - orders.wallet_address ~ '^0x[a-fA-F0-9]{40}$'
  - allocations.status IN ('pending', 'processing', 'completed', 'failed')
  - commissions.status IN ('hold', 'ready', 'paid', 'cancelled')
  - commissions.rate_percent >= 0 AND <= 100
```

### 5.3 æ•°æ®è¿ç§»è§„èŒƒ

```yaml
è¿ç§»åŸåˆ™:
  - MUST æ‰€æœ‰å˜æ›´é€šè¿‡è¿ç§»è„šæœ¬
  - MUST è¿ç§»è„šæœ¬å¯å›æ»š
  - MUST è¿ç§»å‰å¤‡ä»½æ•°æ®
  - MUST åœ¨éé«˜å³°æœŸæ‰§è¡Œ
  - SHOULD åˆ†é˜¶æ®µæ‰§è¡Œå¤§è¿ç§»

è¿ç§»å‘½å:
  æ ¼å¼: YYYYMMDD_HHMM_description
  ç¤ºä¾‹: 20251107_1430_add_wallet_nonces_table

è¿ç§»å†…å®¹:
  - DDL å˜æ›´ï¼ˆè¡¨ã€å­—æ®µã€ç´¢å¼•ï¼‰
  - æ•°æ®è¿ç§»
  - çº¦æŸå˜æ›´
  - è§¦å‘å™¨/å‡½æ•°å˜æ›´

å›æ»šç­–ç•¥:
  - MUST æä¾›å›æ»šè„šæœ¬
  - MUST æµ‹è¯•å›æ»šæµç¨‹
  - SHOULD è®°å½•å›æ»šå½±å“
```

---

## 6. API è®¾è®¡è§„èŒƒ

### 6.1 RESTful è§„èŒƒ

```yaml
URL å‘½åè§„åˆ™:
  - MUST ä½¿ç”¨å°å†™å­—æ¯
  - MUST ä½¿ç”¨è¿å­—ç¬¦åˆ†éš”
  - MUST ä½¿ç”¨å¤æ•°åè¯
  - MUST_NOT åœ¨ URL ä¸­åŒ…å«åŠ¨è¯

  æ­£ç¡®ç¤ºä¾‹:
    GET    /api/v1/users
    GET    /api/v1/users/{user_id}
    POST   /api/v1/orders
    PUT    /api/v1/orders/{order_id}
    DELETE /api/v1/wallets/{wallet_id}
  
  é”™è¯¯ç¤ºä¾‹:
    GET    /api/v1/getUsers
    POST   /api/v1/createOrder
    GET    /api/v1/user_list

HTTP æ–¹æ³•è§„èŒƒ:
  GET:
    ç”¨é€”: æŸ¥è¯¢èµ„æº
    å¹‚ç­‰: æ˜¯
    ç¼“å­˜: å¯ä»¥
  
  POST:
    ç”¨é€”: åˆ›å»ºèµ„æº
    å¹‚ç­‰: å¦ï¼ˆéœ€å®ç°ï¼‰
    ç¼“å­˜: å¦
  
  PUT:
    ç”¨é€”: å®Œæ•´æ›´æ–°èµ„æº
    å¹‚ç­‰: æ˜¯
    ç¼“å­˜: å¦
  
  PATCH:
    ç”¨é€”: éƒ¨åˆ†æ›´æ–°èµ„æº
    å¹‚ç­‰: æ˜¯
    ç¼“å­˜: å¦
  
  DELETE:
    ç”¨é€”: åˆ é™¤èµ„æº
    å¹‚ç­‰: æ˜¯
    ç¼“å­˜: å¦

ç‰ˆæœ¬æ§åˆ¶:
  ç­–ç•¥: URL è·¯å¾„ç‰ˆæœ¬
  æ ¼å¼: /api/v{major}/
  ç¤ºä¾‹: /api/v1/users
  
  ç‰ˆæœ¬å‡çº§è§„åˆ™:
    - æ–°å¢å­—æ®µ: ä¸å‡çº§
    - åˆ é™¤å­—æ®µ: å‡çº§
    - ä¿®æ”¹å­—æ®µç±»å‹: å‡çº§
    - ä¿®æ”¹å“åº”ç»“æ„: å‡çº§
```

### 6.2 è¯·æ±‚è§„èŒƒ

```yaml
è¯·æ±‚å¤´è§„èŒƒ:
  å¿…éœ€:
    Content-Type: application/json
    Authorization: Bearer {token}
  
  å¯é€‰:
    X-Site-Code: ç«™ç‚¹ä»£ç  (é»˜è®¤ NA)
    X-Idempotency-Key: å¹‚ç­‰é”® (POST è¯·æ±‚æ¨è)
    Accept-Language: è¯­è¨€åå¥½

è¯·æ±‚ä½“è§„èŒƒ:
  æ ¼å¼: JSON
  ç¼–ç : UTF-8
  
  å­—æ®µå‘½å:
    - MUST ä½¿ç”¨ snake_case
    - MUST ä½¿ç”¨æœ‰æ„ä¹‰çš„åç§°
    - SHOULD é¿å…ç¼©å†™
  
  æ—¥æœŸæ ¼å¼:
    - MUST ä½¿ç”¨ ISO 8601
    - ç¤ºä¾‹: 2025-11-07T14:30:00Z
  
  é‡‘é¢æ ¼å¼:
    - MUST ä½¿ç”¨å­—ç¬¦ä¸²
    - MUST åŒ…å«å°æ•°ç‚¹
    - ç¤ºä¾‹: "1000.50"
  
  å¸ƒå°”å€¼:
    - MUST ä½¿ç”¨ true/false
    - MUST_NOT ä½¿ç”¨ 1/0

å¹‚ç­‰æ€§å®ç°:
  - MUST POST è¯·æ±‚æ”¯æŒå¹‚ç­‰é”®
  - MUST å¹‚ç­‰é”®å”¯ä¸€
  - MUST ç›¸åŒå¹‚ç­‰é”®è¿”å›ç›¸åŒç»“æœ
  - SHOULD å¹‚ç­‰é”®ä¿ç•™ 48 å°æ—¶
```

### 6.3 å“åº”è§„èŒƒ

```yaml
å“åº”æ ¼å¼:
  æˆåŠŸå“åº”:
    ç»“æ„:
      {
        "data": {},
        "meta": {
          "request_id": "uuid",
          "timestamp": "2025-11-07T14:30:00Z"
        }
      }
  
  é”™è¯¯å“åº”:
    ç»“æ„:
      {
        "error": {
          "code": "ERROR_CODE",
          "message": "Human readable message",
          "details": {}
        },
        "meta": {
          "request_id": "uuid",
          "timestamp": "2025-11-07T14:30:00Z"
        }
      }

HTTP çŠ¶æ€ç è§„èŒƒ:
  2xx æˆåŠŸ:
    200: OK (æŸ¥è¯¢æˆåŠŸ)
    201: Created (åˆ›å»ºæˆåŠŸ)
    204: No Content (åˆ é™¤æˆåŠŸ)
  
  4xx å®¢æˆ·ç«¯é”™è¯¯:
    400: Bad Request (è¯·æ±‚å‚æ•°é”™è¯¯)
    401: Unauthorized (æœªè®¤è¯)
    403: Forbidden (æ— æƒé™)
    404: Not Found (èµ„æºä¸å­˜åœ¨)
    409: Conflict (èµ„æºå†²çª)
    422: Unprocessable Entity (ä¸šåŠ¡é€»è¾‘é”™è¯¯)
    429: Too Many Requests (é™æµ)
  
  5xx æœåŠ¡ç«¯é”™è¯¯:
    500: Internal Server Error (æœåŠ¡å™¨é”™è¯¯)
    503: Service Unavailable (æœåŠ¡ä¸å¯ç”¨)

é”™è¯¯ç è§„èŒƒ:
  æ ¼å¼: {MODULE}_{ERROR_TYPE}_{DETAIL}
  
  ç¤ºä¾‹:
    USER_NOT_FOUND: ç”¨æˆ·ä¸å­˜åœ¨
    ORDER_INSUFFICIENT_STOCK: åº“å­˜ä¸è¶³
    PAYMENT_FAILED: æ”¯ä»˜å¤±è´¥
    WALLET_ADDRESS_INVALID: é’±åŒ…åœ°å€æ— æ•ˆ
    NONCE_EXPIRED: Nonce å·²è¿‡æœŸ

åˆ†é¡µè§„èŒƒ:
  æŸ¥è¯¢å‚æ•°:
    page: é¡µç  (ä» 1 å¼€å§‹)
    page_size: æ¯é¡µæ•°é‡ (é»˜è®¤ 20ï¼Œæœ€å¤§ 100)
  
  å“åº”ç»“æ„:
    {
      "data": [],
      "meta": {
        "page": 1,
        "page_size": 20,
        "total": 100,
        "total_pages": 5
      }
    }
```

### 6.4 æ ¸å¿ƒ API ç«¯ç‚¹

```yaml
è®¤è¯ç›¸å…³:
  POST   /api/v1/auth/nonce                # ç”Ÿæˆ Nonce
  POST   /api/v1/auth/wallet-login         # é’±åŒ…ç™»å½•
  POST   /api/v1/auth/wallet-bind          # ç»‘å®šé’±åŒ…
  DELETE /api/v1/auth/wallet-unbind        # è§£ç»‘é’±åŒ…
  POST   /api/v1/auth/logout               # ç™»å‡º

ç”¨æˆ·ç›¸å…³:
  GET    /api/v1/users/me                  # è·å–å½“å‰ç”¨æˆ·
  PATCH  /api/v1/users/me                  # æ›´æ–°å½“å‰ç”¨æˆ·
  GET    /api/v1/users/me/token-balance    # è·å–ä»£å¸ä½™é¢
  GET    /api/v1/users/me/orders           # è·å–è®¢å•åˆ—è¡¨
  GET    /api/v1/users/me/commissions      # è·å–ä½£é‡‘åˆ—è¡¨

é’±åŒ…ç›¸å…³:
  GET    /api/v1/wallets                   # è·å–é’±åŒ…åˆ—è¡¨
  POST   /api/v1/wallets                   # æ·»åŠ é’±åŒ…
  PUT    /api/v1/wallets/{id}/set-primary  # è®¾ç½®ä¸»é’±åŒ…
  DELETE /api/v1/wallets/{id}              # åˆ é™¤é’±åŒ…

ç«™ç‚¹ç›¸å…³:
  GET    /api/v1/sites                     # è·å–ç«™ç‚¹åˆ—è¡¨
  GET    /api/v1/sites/{code}              # è·å–ç«™ç‚¹è¯¦æƒ…

æ¡£ä½ç›¸å…³:
  GET    /api/v1/tiers                     # è·å–æ¡£ä½åˆ—è¡¨
  GET    /api/v1/tiers/{id}                # è·å–æ¡£ä½è¯¦æƒ…

è®¢å•ç›¸å…³:
  POST   /api/v1/orders                    # åˆ›å»ºè®¢å•
  GET    /api/v1/orders/{id}               # è·å–è®¢å•è¯¦æƒ…
  GET    /api/v1/orders                    # è·å–è®¢å•åˆ—è¡¨

Webhook:
  POST   /api/v1/webhooks/stripe           # Stripe Webhook
  POST   /api/v1/webhooks/fireblocks       # Fireblocks Webhook

ç®¡ç†å‘˜ API:
  GET    /api/v1/admin/allocations         # è·å–å¾…å‘æ”¾åˆ—è¡¨
  POST   /api/v1/admin/allocations/batch   # æ‰¹é‡å‘æ”¾
  POST   /api/v1/admin/allocations/{id}/retry  # é‡è¯•å‘æ”¾
  GET    /api/v1/admin/orders              # è®¢å•ç®¡ç†
  GET    /api/v1/admin/commissions         # ä½£é‡‘ç®¡ç†
  POST   /api/v1/admin/commissions/settle  # ä½£é‡‘ç»“ç®—
```

---

## 7. è®¤è¯ä¸æˆæƒè§„èŒƒ

### 7.1 è®¤è¯æ–¹å¼

```yaml
æ”¯æŒçš„è®¤è¯æ–¹å¼:
  1. Auth0 ä¼ ç»Ÿç™»å½•:
     ç±»å‹: Email + Password
     å®ç°: @auth0/nextjs-auth0
     Token: Auth0 JWT
     
  2. Auth0 Passkey:
     ç±»å‹: WebAuthn / FIDO2
     å®ç°: Auth0 Passwordless
     Token: Auth0 JWT
     
  3. WalletConnect:
     ç±»å‹: Web3 é’±åŒ…ç­¾å
     å®ç°: @web3modal/wagmi + SIWE
     Token: Auth0 JWT (æ¨è) æˆ– è‡ªç­¾å‘ JWT

JWT è§„èŒƒ:
  ç®—æ³•: RS256 (Auth0) æˆ– HS256 (è‡ªç­¾å‘)
  è¿‡æœŸæ—¶é—´: 24 å°æ—¶
  åˆ·æ–°ç­–ç•¥: Refresh Token (Auth0)
  
  Payload å¿…å«:
    sub: ç”¨æˆ·å”¯ä¸€æ ‡è¯†
    iss: ç­¾å‘è€…
    aud: å—ä¼—
    exp: è¿‡æœŸæ—¶é—´
    iat: ç­¾å‘æ—¶é—´
    
  Payload æ‰©å±• (è‡ªå®šä¹‰å£°æ˜):
    https://posx.io/user_id: ç”¨æˆ· ID
    https://posx.io/roles: è§’è‰²åˆ—è¡¨
    https://posx.io/permissions: æƒé™åˆ—è¡¨
```

### 7.2 Nonce å®‰å…¨è§„èŒƒ

```yaml
Nonce ç”Ÿæˆè§„åˆ™:
  - MUST ä½¿ç”¨å¯†ç å­¦å®‰å…¨éšæœºæ•°
  - MUST é•¿åº¦è‡³å°‘ 32 å­—èŠ‚
  - MUST å…³è”é’±åŒ…åœ°å€
  - MUST è®¾ç½®è¿‡æœŸæ—¶é—´ï¼ˆ5 åˆ†é’Ÿï¼‰

Nonce éªŒè¯è§„åˆ™:
  - MUST éªŒè¯ Nonce å­˜åœ¨
  - MUST éªŒè¯æœªè¿‡æœŸ
  - MUST éªŒè¯æœªä½¿ç”¨
  - MUST éªŒè¯é’±åŒ…åœ°å€åŒ¹é…
  - MUST ä½¿ç”¨åæ ‡è®°ä¸ºå·²ç”¨

Nonce å­˜å‚¨:
  - MUST å­˜å‚¨åœ¨æ•°æ®åº“
  - MUST è®°å½•åˆ›å»ºæ—¶é—´
  - MUST è®°å½•è¿‡æœŸæ—¶é—´
  - SHOULD è®°å½• IP åœ°å€ï¼ˆè„±æ•ï¼‰
  - SHOULD è®°å½• User-Agentï¼ˆæˆªæ–­ï¼‰

Nonce æ¸…ç†:
  - MUST å®šæœŸæ¸…ç†è¿‡æœŸ Nonce
  - SHOULD æ¯å°æ—¶æ‰§è¡Œä¸€æ¬¡
```

### 7.3 æƒé™æ¨¡å‹

```yaml
è§’è‰²å®šä¹‰:
  user:
    æè¿°: æ™®é€šç”¨æˆ·
    æƒé™:
      - orders:read (è‡ªå·±çš„è®¢å•)
      - orders:write (åˆ›å»ºè®¢å•)
      - wallets:read (è‡ªå·±çš„é’±åŒ…)
      - wallets:write (ç®¡ç†é’±åŒ…)
      - commissions:read (è‡ªå·±çš„ä½£é‡‘)
  
  agent:
    æè¿°: ä»£ç†
    ç»§æ‰¿: user
    é¢å¤–æƒé™:
      - commissions:read (ä¸‹çº§ä½£é‡‘)
      - referrals:read (ä¸‹çº§ç”¨æˆ·)
  
  admin:
    æè¿°: ç®¡ç†å‘˜
    æƒé™:
      - *:* (æ‰€æœ‰æƒé™)

æƒé™æ£€æŸ¥:
  ä½ç½®: ä¸­é—´ä»¶ + è§†å›¾è£…é¥°å™¨
  ç­–ç•¥: RBAC (åŸºäºè§’è‰²)
  å®ç°: 
    - åç«¯: Django Permission æˆ– JWT Claims
    - å‰ç«¯: åŸºäºè§’è‰²æ˜¾ç¤º/éšè—ç»„ä»¶
```

---

## 8. æ”¯ä»˜ä¸è®¢å•è§„èŒƒ

### 8.1 Stripe é›†æˆè§„èŒƒ

```yaml
Stripe é…ç½®:
  API ç‰ˆæœ¬: 2024-11-20.acacia
  å¯†é’¥ç±»å‹: Secret Key (åç«¯) + Publishable Key (å‰ç«¯)
  æµ‹è¯•æ¨¡å¼: ä½¿ç”¨ test_ å¯†é’¥
  ç”Ÿäº§æ¨¡å¼: ä½¿ç”¨ live_ å¯†é’¥

Payment Intent åˆ›å»º:
  å‚æ•°:
    amount: é‡‘é¢ï¼ˆç¾åˆ†ï¼‰
    currency: usd
    payment_method_types: [card]
    metadata:
      order_id: è®¢å• ID
      site_code: ç«™ç‚¹ä»£ç 
      user_id: ç”¨æˆ· ID
      wallet_address: é’±åŒ…åœ°å€

Webhook è®¢é˜…äº‹ä»¶:
  1. payment_intent.succeeded:
     è§¦å‘: æ”¯ä»˜æˆåŠŸ
     åŠ¨ä½œ:
       - æ›´æ–°è®¢å•çŠ¶æ€ â†’ paid
       - è®°å½• paid_at
       - ç”Ÿæˆä½£é‡‘
       - åˆ›å»ºåˆ†é…è®°å½•
  
  2. payment_intent.payment_failed:
     è§¦å‘: æ”¯ä»˜å¤±è´¥
     åŠ¨ä½œ:
       - æ›´æ–°è®¢å•çŠ¶æ€ â†’ failed
       - è®°å½•å¤±è´¥åŸå› 
       - é‡Šæ”¾åº“å­˜
  
  3. charge.dispute.created:
     è§¦å‘: é“¶è¡Œæ‹’ä»˜/äº‰è®®
     åŠ¨ä½œ:
       - æ ‡è®°è®¢å• disputed=true
       - è®°å½•äº‰è®®ä¿¡æ¯
       - å‘é€å‘Šè­¦é€šçŸ¥
       - ä¸æ”¹å˜è®¢å•çŠ¶æ€

Webhook å®‰å…¨:
  - MUST éªŒè¯ç­¾å (Stripe-Signature header)
  - MUST ä½¿ç”¨ Webhook Secret
  - MUST å¹‚ç­‰å¤„ç†ï¼ˆå”¯ä¸€çº¦æŸï¼‰
  - MUST å¿«é€Ÿè¿”å› 200
  - MUST å¼‚æ­¥å¤„ç†ä¸šåŠ¡é€»è¾‘
  - MUST è®°å½•æ‰€æœ‰ Webhook æ—¥å¿—
```

### 8.2 è®¢å•åˆ›å»ºè§„èŒƒ

```yaml
å‰ç½®æ¡ä»¶æ£€æŸ¥:
  - MUST ç”¨æˆ·å·²ç™»å½•
  - MUST ç”¨æˆ·æœ‰ä¸»é’±åŒ…åœ°å€
  - MUST é’±åŒ…åœ°å€å·²éªŒè¯
  - MUST æ¡£ä½åº“å­˜å……è¶³
  - MUST æä¾›å¹‚ç­‰é”®

è®¢å•åˆ›å»ºæµç¨‹:
  1. éªŒè¯å¹‚ç­‰é”®:
     - æ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨
     - å­˜åœ¨åˆ™è¿”å›æ—¢æœ‰è®¢å•
  
  2. éªŒè¯é’±åŒ…åœ°å€:
     - æ£€æŸ¥ user.primary_wallet_id
     - éªŒè¯åœ°å€æ ¼å¼
     - ä¸å­˜åœ¨è¿”å› WALLET_ADDRESS_REQUIRED
  
  3. é”å®šåº“å­˜:
     - ä½¿ç”¨ SELECT FOR UPDATE
     - æ£€æŸ¥ available_units >= quantity
     - æ›´æ–° sold_units += quantity
     - æ›´æ–° version += 1
  
  4. è®¡ç®—ä»·æ ¼:
     - list_price = tier.list_price_usd * quantity
     - åº”ç”¨æŠ˜æ‰£ï¼ˆå–è¾ƒå¤§å€¼ï¼‰
     - final_price = list_price * (1 - discount/100)
  
  5. åˆ›å»ºè®¢å•è®°å½•:
     - ç”Ÿæˆ order_id
     - status = pending
     - è®°å½•é’±åŒ…åœ°å€
     - è®°å½•ä»·æ ¼
     - è®¾ç½®è¿‡æœŸæ—¶é—´ (created_at + 15 min)
  
  6. åˆ›å»º Stripe Payment Intent:
     - è°ƒç”¨ Stripe API
     - è®°å½• payment_intent_id
     - è¿”å› client_secret
  
  7. è®°å½•å¹‚ç­‰é”®:
     - å…³è” order_id
     - è®°å½•å“åº”ä½“

è®¢å•è¶…æ—¶å–æ¶ˆ:
  - MUST å®šæœŸæ‰«æï¼ˆæ¯ 5 åˆ†é’Ÿï¼‰
  - æ¡ä»¶: status=pending AND created_at < now() - 15min
  - åŠ¨ä½œ:
    - æ›´æ–° status â†’ cancelled
    - è®°å½• cancelled_at
    - é‡Šæ”¾åº“å­˜
```

### 8.3 åº“å­˜æ§åˆ¶è§„èŒƒ

```yaml
åº“å­˜å­—æ®µ:
  total_units: æ€»åº“å­˜ï¼ˆä¸å˜ï¼‰
  sold_units: å·²å”®å‡ºï¼ˆé€’å¢ï¼‰
  available_units: å¯ç”¨åº“å­˜ (total - sold)
  version: ç‰ˆæœ¬å·ï¼ˆä¹è§‚é”ï¼‰

ä¹è§‚é”å®ç°:
  æ›´æ–° SQL:
    UPDATE tiers
    SET sold_units = sold_units + {quantity},
        version = version + 1
    WHERE tier_id = {id}
      AND version = {expected_version}
      AND available_units >= {quantity}
  
  æ£€æŸ¥:
    IF affected_rows = 0 THEN
      RAISE InsufficientStockError
    END IF

å¹¶å‘æ§åˆ¶:
  - MUST ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡
  - MUST ä½¿ç”¨ SELECT FOR UPDATE é”å®š
  - MUST ä½¿ç”¨ç‰ˆæœ¬å·ä¹è§‚é”
  - MUST æ•è·å¹¶å‘å†²çªå¼‚å¸¸
  - SHOULD å®ç°é‡è¯•æœºåˆ¶ï¼ˆæœ€å¤š 3 æ¬¡ï¼‰
```

---

## 9. ä»£å¸åˆ†é…è§„èŒƒ

### 9.1 Fireblocks é›†æˆè§„èŒƒ

```yaml
Fireblocks é…ç½®:
  è®¤è¯æ–¹å¼: API Key + RSA Private Key
  API Base URL: https://api.fireblocks.io
  Vault Account: ä¸»è´¦æˆ· ID
  Asset ID: ä»£å¸èµ„äº§ ID (å¦‚ ETH_TEST)

API Key ç”Ÿæˆ:
  ä½ç½®: Fireblocks Console â†’ Settings â†’ API Users
  ç±»å‹: Admin æˆ– Editor
  æƒé™: Transaction Signing

Private Key ç”Ÿæˆ:
  ç®—æ³•: RSA 4096
  æ ¼å¼: PEM
  å­˜å‚¨: ç¯å¢ƒå˜é‡ï¼ˆåŠ å¯†ï¼‰

å‘å¸æµç¨‹:
  1. ç®¡ç†å‘˜é€‰æ‹©å¾…å‘æ”¾æ‰¹æ¬¡:
     - æŸ¥è¯¢ allocations (status=pending)
     - æœ€å¤šé€‰æ‹© 100 ç¬”
  
  2. è°ƒç”¨ Fireblocks API:
     - endpoint: /v1/transactions
     - method: POST
     - å‚æ•°:
       assetId: èµ„äº§ ID
       source: Vault Account
       destination: ç”¨æˆ·é’±åŒ…åœ°å€
       amount: ä»£å¸æ•°é‡
       note: è®¢å•å¤‡æ³¨
  
  3. æ›´æ–°åˆ†é…çŠ¶æ€:
     - status â†’ processing
     - è®°å½• fireblocks_tx_id
     - è®°å½• processing_at
  
  4. ç­‰å¾… Fireblocks å›è°ƒ:
     - æ¥æ”¶ Webhook
     - éªŒè¯ç­¾å
     - æ›´æ–°çŠ¶æ€
  
  5. æœ€ç»ˆçŠ¶æ€:
     - completed: è®°å½• tx_hash, confirmed_at
     - failed: è®°å½• failure_reason

æ‰¹é‡å‘æ”¾é™åˆ¶:
  - MUST æœ€å¤š 100 ç¬”/æ‰¹æ¬¡
  - SHOULD æ§åˆ¶å‘æ”¾é¢‘ç‡ï¼ˆé¿å…è§¦å‘é™æµï¼‰
  - MUST è®°å½•æ‰€æœ‰å¤±è´¥åŸå› 
  - MUST æ”¯æŒå¤±è´¥é‡è¯•
```

### 9.2 Fireblocks Webhook è§„èŒƒ

```yaml
Webhook é…ç½®:
  URL: https://api.posx.io/api/v1/webhooks/fireblocks
  Events:
    - TRANSACTION_STATUS_UPDATED

ç­¾åéªŒè¯:
  ç®—æ³•: RSA-SHA512
  Header: X-Fireblocks-Signature
  å…¬é’¥æ¥æº: Fireblocks Console

  éªŒè¯æ­¥éª¤:
    1. è·å–ç­¾å Header
    2. åŠ è½½ Fireblocks å…¬é’¥
    3. ä½¿ç”¨ RSA-SHA512 éªŒè¯
    4. éªŒè¯å¤±è´¥è¿”å› 403

äº‹ä»¶å¤„ç†:
  TRANSACTION_STATUS_UPDATED:
    COMPLETED:
      - æ›´æ–° allocation.status â†’ completed
      - è®°å½• tx_hash
      - è®°å½• confirmed_at
    
    FAILED:
      - æ›´æ–° allocation.status â†’ failed
      - è®°å½• failure_reason
    
    CANCELLED:
      - æ›´æ–° allocation.status â†’ failed
      - è®°å½• failure_reason

å¹‚ç­‰æ€§ä¿è¯:
  - MUST ä½¿ç”¨å”¯ä¸€çº¦æŸ (source, external_event_id)
  - MUST å¿«é€Ÿè¿”å› 200
  - MUST å¼‚æ­¥å¤„ç†ä¸šåŠ¡é€»è¾‘
```

### 9.3 ä»£å¸ä½™é¢æ˜¾ç¤ºè§„èŒƒ

```yaml
æ•°æ®æ¥æº:
  æ€»è´­ä¹°é‡:
    æ¥æº: æœ¬åœ°æ•°æ®åº“
    è®¡ç®—: SUM(orders.quantity * tier.tokens_per_unit)
    æ¡ä»¶: orders.status = 'paid'
  
  å·²å‘æ”¾é‡:
    æ¥æº: Fireblocks API
    æ¥å£: /v1/vault/accounts/{id}/assets/{asset_id}
    å­—æ®µ: total
  
  é”ä»“é‡:
    æ¥æº: Fireblocks API
    æ¥å£: /v1/vault/accounts/{id}/vesting
    å­—æ®µ: locked_amount
  
  å¯ç”¨é‡:
    è®¡ç®—: total - locked
  
  è§£é”æ—¶é—´è¡¨:
    æ¥æº: Fireblocks Vesting é…ç½®
    æ ¼å¼: [{date, amount}, ...]

æŸ¥è¯¢é¢‘ç‡:
  - SHOULD ç¼“å­˜ 5 åˆ†é’Ÿ
  - SHOULD åå°å®šæœŸåŒæ­¥
  - MAY ç”¨æˆ·ä¸»åŠ¨åˆ·æ–°

æ˜¾ç¤ºè§„åˆ™:
  - MUST æ˜¾ç¤ºæ‰€æœ‰å››ä¸ªæŒ‡æ ‡
  - MUST æ˜¾ç¤ºè§£é”æ—¶é—´è¡¨
  - SHOULD æ˜¾ç¤ºå•ä½ï¼ˆPOSXï¼‰
  - SHOULD æ ¼å¼åŒ–å¤§æ•°å­—
```

---

## 10. ä½£é‡‘ç³»ç»Ÿè§„èŒƒ

### 10.1 ä½£é‡‘é…ç½®è§„èŒƒ

```yaml
é…ç½®å±‚çº§:
  1. ç«™ç‚¹é»˜è®¤é…ç½®:
     èŒƒå›´: æ•´ä¸ªç«™ç‚¹
     ä¼˜å…ˆçº§: æœ€ä½
     ç¤ºä¾‹: NA ç«™ç‚¹é»˜è®¤ 2 å±‚ï¼ˆ12%, 4%ï¼‰
  
  2. ä»£ç†è‡ªå®šä¹‰é…ç½®:
     èŒƒå›´: ç‰¹å®šä»£ç†
     ä¼˜å…ˆçº§: æœ€é«˜
     ç¤ºä¾‹: VIP ä»£ç† 3 å±‚ï¼ˆ15%, 6%, 3%ï¼‰

é…ç½®å‚æ•°:
  config_name: é…ç½®åç§°
  levels: å±‚çº§é…ç½®åˆ—è¡¨
    - level: å±‚çº§ï¼ˆ1, 2, 3...ï¼‰
    - rate_percent: ä½£é‡‘æ¯”ä¾‹
    - max_amount_usd: å•ç¬”æœ€å¤§é‡‘é¢ï¼ˆå¯é€‰ï¼‰
    - min_amount_usd: å•ç¬”æœ€å°é‡‘é¢ï¼ˆå¯é€‰ï¼‰
    - is_enabled: æ˜¯å¦å¯ç”¨
  
  rules: ç‰¹æ®Šè§„åˆ™ï¼ˆå¯é€‰ï¼‰
    - rule_type: è§„åˆ™ç±»å‹ï¼ˆsunline/tiered/cappedï¼‰
    - rule_config: è§„åˆ™é…ç½®ï¼ˆJSONï¼‰

é…ç½®ç”Ÿæ•ˆè§„åˆ™:
  1. æŸ¥è¯¢ä»£ç†æ˜¯å¦æœ‰è‡ªå®šä¹‰é…ç½®
  2. æœ‰åˆ™ä½¿ç”¨ä»£ç†é…ç½®
  3. æ— åˆ™ä½¿ç”¨ç«™ç‚¹é»˜è®¤é…ç½®
  4. æŒ‰ç”Ÿæ•ˆæ—¶é—´èŒƒå›´åŒ¹é…
```

### 10.2 ä½£é‡‘è®¡ç®—è§„èŒƒ

```yaml
è®¡ç®—è§¦å‘:
  æ—¶æœº: è®¢å•æ”¯ä»˜æˆåŠŸå
  è¾“å…¥:
    - order_id: è®¢å• ID
    - order_amount: è®¢å•é‡‘é¢
    - buyer_id: è´­ä¹°è€… ID
    - site_id: ç«™ç‚¹ ID

è®¡ç®—æµç¨‹:
  1. è·å–ä½£é‡‘é…ç½®:
     - æŸ¥è¯¢è´­ä¹°è€…çš„æ¨èäºº
     - é€’å½’å‘ä¸ŠæŸ¥æ‰¾ N å±‚
     - è·å–æ¯å±‚ä»£ç†çš„é…ç½®
  
  2. è®¡ç®—æ¯å±‚ä½£é‡‘:
     FOR level IN 1..N:
       agent = get_agent_at_level(level)
       IF agent IS NULL: BREAK
       
       config = get_commission_config(agent, site_id)
       level_config = config.levels[level]
       
       IF NOT level_config.is_enabled: CONTINUE
       
       rate = level_config.rate_percent
       amount = order_amount * rate / 100
       
       # åº”ç”¨é‡‘é¢é™åˆ¶
       IF max_amount IS NOT NULL:
         amount = MIN(amount, max_amount)
       IF min_amount IS NOT NULL AND amount < min_amount:
         SKIP
       
       # åˆ›å»ºä½£é‡‘è®°å½•
       CREATE commission:
         order_id: order_id
         agent_id: agent.user_id
         level: level
         rate_percent: rate
         commission_amount_usd: amount
         status: 'hold'
         hold_until: now() + hold_period
  
  3. åº”ç”¨ç‰¹æ®Šè§„åˆ™:
     - å¤ªé˜³çº¿è§„åˆ™: åŒä¸€è®¢å•åªè®¡ç®—ä¸€æ¬¡
     - å°é¡¶è§„åˆ™: å•æ—¥/å•æœˆä½£é‡‘ä¸Šé™
     - é˜¶æ¢¯è§„åˆ™: æ ¹æ®ä¸šç»©è°ƒæ•´æ¯”ä¾‹

å”¯ä¸€æ€§ä¿è¯:
  - MUST ä½¿ç”¨å”¯ä¸€çº¦æŸ (order_id, agent_id, level)
  - MUST é¿å…é‡å¤è®¡ç®—
  - MUST äº‹åŠ¡å†…å®Œæˆ
```

### 10.3 ä½£é‡‘ç»“ç®—è§„èŒƒ

```yaml
å†»ç»“æœŸè§„åˆ™:
  é»˜è®¤: 7 å¤©
  å¯é…ç½®: æŒ‰ç«™ç‚¹æˆ–ä»£ç†
  ç›®çš„: é˜²æ­¢é€€æ¬¾/æ‹’ä»˜ï¼ˆè™½ç„¶æ— é€€æ¬¾ï¼Œä½†ä¿ç•™æœºåˆ¶ï¼‰

çŠ¶æ€è½¬æ¢:
  hold â†’ ready:
    è§¦å‘: å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å°æ—¶ï¼‰
    æ¡ä»¶: hold_until <= now()
    åŠ¨ä½œ: æ›´æ–° status = 'ready'
  
  ready â†’ paid:
    è§¦å‘: ç®¡ç†å‘˜ç»“ç®—
    æ¡ä»¶: status = 'ready'
    åŠ¨ä½œ:
      - æ›´æ–° status = 'paid'
      - è®°å½• paid_at
      - è½¬è´¦åˆ°ä»£ç†è´¦æˆ·ï¼ˆStripe Connectï¼‰
  
  * â†’ cancelled:
    è§¦å‘: è®¢å•å–æ¶ˆ
    æ¡ä»¶: order.status = 'cancelled'
    åŠ¨ä½œ: æ›´æ–° status = 'cancelled'

ç»“ç®—æ–¹å¼:
  1. æ‰‹åŠ¨ç»“ç®—:
     - ç®¡ç†å‘˜é€‰æ‹©ä»£ç†
     - æŸ¥çœ‹å¯ç»“ç®—ä½£é‡‘
     - ç¡®è®¤ç»“ç®—
     - è°ƒç”¨ Stripe Transfer API
  
  2. è‡ªåŠ¨ç»“ç®—ï¼ˆå¯é€‰ï¼‰:
     - å®šæ—¶ä»»åŠ¡ï¼ˆæ¯å‘¨/æ¯æœˆï¼‰
     - è‡ªåŠ¨ç»“ç®—æ‰€æœ‰ ready çŠ¶æ€
     - å‘é€ç»“ç®—é€šçŸ¥

ç»“ç®—è®°å½•:
  - MUST è®°å½•ç»“ç®—æ‰¹æ¬¡
  - MUST è®°å½•è½¬è´¦è¯¦æƒ…
  - MUST å¯è¿½æº¯åˆ°è®¢å•
  - SHOULD ç”Ÿæˆç»“ç®—æŠ¥è¡¨
```

---

## 11. å®‰å…¨è§„èŒƒ

### 11.1 æ•°æ®å®‰å…¨

```yaml
æ•æ„Ÿæ•°æ®ä¿æŠ¤:
  åŠ å¯†å­˜å‚¨:
    - Fireblocks Private Key (ç¯å¢ƒå˜é‡åŠ å¯†)
    - Stripe Secret Key (ç¯å¢ƒå˜é‡åŠ å¯†)
    - æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²ï¼ˆåŠ å¯†ï¼‰
  
  ä¼ è¾“åŠ å¯†:
    - MUST ä½¿ç”¨ HTTPS/TLS 1.3
    - MUST ä½¿ç”¨æœ‰æ•ˆè¯ä¹¦
    - MUST_NOT ä½¿ç”¨è‡ªç­¾åè¯ä¹¦ï¼ˆç”Ÿäº§ï¼‰
  
  è®¿é—®æ§åˆ¶:
    - MUST æœ€å°æƒé™åŸåˆ™
    - MUST å®šæœŸå®¡è®¡æƒé™
    - SHOULD ä½¿ç”¨ IAM è§’è‰²

æ•°æ®è„±æ•:
  æ—¥å¿—è®°å½•:
    - MUST_NOT è®°å½•å¯†ç 
    - MUST_NOT è®°å½•å®Œæ•´ä¿¡ç”¨å¡å·
    - SHOULD è„±æ•é’±åŒ…åœ°å€ï¼ˆä»…æ˜¾ç¤ºå‰ 6 å 4 ä½ï¼‰
    - SHOULD è„±æ• IP åœ°å€
    - SHOULD è„±æ• User-Agentï¼ˆæˆªæ–­ï¼‰
  
  æ•°æ®å¯¼å‡º:
    - MUST è„±æ•æ•æ„Ÿå­—æ®µ
    - MUST è®°å½•å¯¼å‡ºæ—¥å¿—
    - SHOULD é™åˆ¶å¯¼å‡ºé¢‘ç‡

å¤‡ä»½ç­–ç•¥:
  æ•°æ®åº“:
    - MUST æ¯æ—¥å…¨é‡å¤‡ä»½
    - MUST æ¯å°æ—¶å¢é‡å¤‡ä»½
    - MUST å¼‚åœ°å­˜å‚¨
    - MUST åŠ å¯†å¤‡ä»½æ–‡ä»¶
    - MUST å®šæœŸæµ‹è¯•æ¢å¤
  
  ä¿ç•™æœŸé™:
    - å…¨é‡å¤‡ä»½: 30 å¤©
    - å¢é‡å¤‡ä»½: 7 å¤©
    - å½’æ¡£æ•°æ®: 7 å¹´ï¼ˆæ ¹æ®åˆè§„è¦æ±‚ï¼‰
```

### 11.2 API å®‰å…¨

```yaml
è®¤è¯å®‰å…¨:
  - MUST æ‰€æœ‰ API éœ€è¦è®¤è¯ï¼ˆé™¤å…¬å¼€ç«¯ç‚¹ï¼‰
  - MUST éªŒè¯ JWT ç­¾å
  - MUST æ£€æŸ¥ JWT è¿‡æœŸæ—¶é—´
  - MUST éªŒè¯ JWT audience
  - SHOULD å®ç° Token é»‘åå•ï¼ˆå¯é€‰ï¼‰

æˆæƒå®‰å…¨:
  - MUST éªŒè¯ç”¨æˆ·æƒé™
  - MUST éªŒè¯èµ„æºæ‰€æœ‰æƒ
  - MUST å®ç° RBAC
  - SHOULD è®°å½•æƒé™æ£€æŸ¥æ—¥å¿—

è¾“å…¥éªŒè¯:
  - MUST éªŒè¯æ‰€æœ‰è¾“å…¥å‚æ•°
  - MUST ä½¿ç”¨ç™½åå•éªŒè¯
  - MUST éªŒè¯æ•°æ®ç±»å‹
  - MUST éªŒè¯æ•°æ®èŒƒå›´
  - MUST é˜²æ­¢ SQL æ³¨å…¥
  - MUST é˜²æ­¢ XSS æ”»å‡»
  - MUST é˜²æ­¢ CSRF æ”»å‡»

è¾“å‡ºç¼–ç :
  - MUST è½¬ä¹‰ HTML è¾“å‡º
  - MUST è½¬ä¹‰ SQL å‚æ•°
  - MUST è½¬ä¹‰ JSON è¾“å‡º
  - SHOULD ä½¿ç”¨ ORM/æ¡†æ¶å†…ç½®æ–¹æ³•

é™æµç­–ç•¥:
  å…¨å±€é™æµ:
    - 1000 req/min per IP
    - 10000 req/hour per IP
  
  API é™æµ:
    - ç™»å½•: 5 req/min per IP
    - åˆ›å»ºè®¢å•: 10 req/min per user
    - é’±åŒ…ç™»å½•: 3 req/min per wallet
  
  å®ç°:
    - SHOULD ä½¿ç”¨ Redis
    - SHOULD è¿”å› 429 çŠ¶æ€ç 
    - SHOULD åŒ…å« Retry-After header
```

### 11.3 Webhook å®‰å…¨

```yaml
Stripe Webhook:
  éªŒè¯æ–¹å¼: HMAC-SHA256
  ç­¾å Header: Stripe-Signature
  éªŒè¯åº“: stripe.webhook.construct_event
  
  å®‰å…¨æªæ–½:
    - MUST éªŒè¯ç­¾å
    - MUST ä½¿ç”¨ Webhook Secret
    - MUST è®°å½•æ‰€æœ‰è¯·æ±‚
    - MUST å¹‚ç­‰å¤„ç†
    - SHOULD é™åˆ¶æ¥æº IP

Fireblocks Webhook:
  éªŒè¯æ–¹å¼: RSA-SHA512
  ç­¾å Header: X-Fireblocks-Signature
  å…¬é’¥æ¥æº: Fireblocks Console
  
  éªŒè¯æ­¥éª¤:
    1. è§£æç­¾å Header (Base64)
    2. åŠ è½½å…¬é’¥ (PEM æ ¼å¼)
    3. éªŒè¯ç­¾å:
       public_key.verify(
         signature,
         payload,
         padding.PKCS1v15(),
         hashes.SHA512()
       )
    4. éªŒè¯å¤±è´¥è¿”å› 403
  
  å®‰å…¨æªæ–½:
    - MUST éªŒè¯ç­¾å
    - MUST è®°å½•æ‰€æœ‰è¯·æ±‚
    - MUST å¹‚ç­‰å¤„ç†
    - SHOULD é™åˆ¶æ¥æº IP

é€šç”¨è§„åˆ™:
  - MUST å¿«é€Ÿè¿”å› 200
  - MUST å¼‚æ­¥å¤„ç†ä¸šåŠ¡é€»è¾‘
  - MUST è®°å½•å¤„ç†ç»“æœ
  - MUST å®ç°é‡è¯•æœºåˆ¶
  - SHOULD å‘Šè­¦å¼‚å¸¸äº‹ä»¶
```

---

## 12. ç¯å¢ƒé…ç½®è§„èŒƒ

### 12.1 ç¯å¢ƒå®šä¹‰

```yaml
ç¯å¢ƒç±»å‹:
  local:
    ç”¨é€”: æœ¬åœ°å¼€å‘
    æ•°æ®: å¼€å‘æ•°æ® / Mock æ•°æ®
    å¤–éƒ¨æœåŠ¡: æµ‹è¯•ç¯å¢ƒæˆ– Mock
    æ—¥å¿—çº§åˆ«: DEBUG
  
  demo:
    ç”¨é€”: æ¼”ç¤º / ç”¨æˆ·éªŒæ”¶æµ‹è¯•
    æ•°æ®: æ¼”ç¤ºæ•°æ® / çœŸå®æµ‹è¯•æ•°æ®
    å¤–éƒ¨æœåŠ¡: æµ‹è¯•ç¯å¢ƒ
    æ—¥å¿—çº§åˆ«: INFO
    åŸŸå: demo.posx.io
  
  production:
    ç”¨é€”: ç”Ÿäº§ç¯å¢ƒ
    æ•°æ®: çœŸå®ç”Ÿäº§æ•°æ®
    å¤–éƒ¨æœåŠ¡: ç”Ÿäº§ç¯å¢ƒ
    æ—¥å¿—çº§åˆ«: WARNING
    åŸŸå: posx.io

ç¯å¢ƒéš”ç¦»:
  - MUST ç‰©ç†éš”ç¦»ï¼ˆä¸åŒæœåŠ¡å™¨/é›†ç¾¤ï¼‰
  - MUST æ•°æ®éš”ç¦»ï¼ˆä¸åŒæ•°æ®åº“ï¼‰
  - MUST å¯†é’¥éš”ç¦»ï¼ˆä¸åŒ API Keyï¼‰
  - SHOULD ç½‘ç»œéš”ç¦»ï¼ˆVPCï¼‰
```

### 12.2 æœ¬åœ°å¼€å‘ç¯å¢ƒ

```yaml
ç³»ç»Ÿè¦æ±‚:
  æ“ä½œç³»ç»Ÿ: macOS / Linux / Windows (WSL2)
  Docker: 20.10+
  Docker Compose: 2.0+
  Python: 3.11+
  Node.js: 20+
  Git: 2.30+

å¿…éœ€æœåŠ¡:
  - PostgreSQL 15 (Docker)
  - Redis 7 (Docker)
  - Backend API (Django)
  - Frontend (Next.js)
  - Celery Worker (å¯é€‰)
  - Celery Beat (å¯é€‰)

ç¯å¢ƒå˜é‡ (Backend):
  # Django
  DJANGO_ENV=local
  DEBUG=true
  SECRET_KEY=<random-string>
  ALLOWED_HOSTS=localhost,127.0.0.1
  
  # Database
  DATABASE_URL=postgresql://posx:posx@localhost:5432/posx_local
  
  # Redis
  REDIS_URL=redis://localhost:6379/0
  CELERY_BROKER_URL=redis://localhost:6379/0
  
  # Auth0
  AUTH0_DOMAIN=dev-xxx.auth0.com
  AUTH0_AUDIENCE=https://api.posx.local
  AUTH0_ISSUER=https://dev-xxx.auth0.com/
  AUTH0_M2M_CLIENT_ID=xxx
  AUTH0_M2M_CLIENT_SECRET=xxx
  
  # Stripe (æµ‹è¯•å¯†é’¥)
  STRIPE_SECRET_KEY=sk_test_xxx
  STRIPE_PUBLISHABLE_KEY=pk_test_xxx
  STRIPE_WEBHOOK_SECRET=whsec_xxx
  
  # Fireblocks (æµ‹è¯•ç¯å¢ƒ)
  FIREBLOCKS_API_KEY=xxx
  FIREBLOCKS_PRIVATE_KEY=<pem-content>
  FIREBLOCKS_BASE_URL=https://sandbox-api.fireblocks.io
  FIREBLOCKS_VAULT_ACCOUNT_ID=0
  FIREBLOCKS_ASSET_ID=ETH_TEST
  FIREBLOCKS_WEBHOOK_PUBLIC_KEY=<pem-content>
  
  # Blockchain (æµ‹è¯•ç½‘)
  ETH_RPC_URL=https://sepolia.infura.io/v3/xxx
  TOKEN_CONTRACT_ADDRESS=0x...
  
  # å…¶ä»–
  FRONTEND_URL=http://localhost:3000
  CORS_ALLOWED_ORIGINS=http://localhost:3000
  ALLOWED_SITE_CODES=NA,ASIA
  NONCE_TTL_MINUTES=5
  IDEMPOTENCY_KEY_RETENTION_HOURS=48

ç¯å¢ƒå˜é‡ (Frontend):
  # Auth0
  AUTH0_BASE_URL=http://localhost:3000
  AUTH0_ISSUER_BASE_URL=https://dev-xxx.auth0.com
  AUTH0_CLIENT_ID=xxx
  AUTH0_CLIENT_SECRET=xxx
  AUTH0_SECRET=<random-string>
  
  # API
  NEXT_PUBLIC_API_URL=http://localhost:8000/api
  
  # Stripe
  NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_test_xxx
  
  # WalletConnect
  NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID=xxx
  
  # Blockchain
  NEXT_PUBLIC_ETH_RPC_URL=https://sepolia.infura.io/v3/xxx
  NEXT_PUBLIC_TOKEN_CONTRACT_ADDRESS=0x...
  
  # Site
  NEXT_PUBLIC_SITE_CODE=NA

å¯åŠ¨å‘½ä»¤:
  # å¯åŠ¨åŸºç¡€æœåŠ¡
  docker-compose up -d postgres redis
  
  # å¯åŠ¨åç«¯
  cd backend
  python manage.py migrate
  python manage.py runserver
  
  # å¯åŠ¨å‰ç«¯
  cd frontend
  npm install
  npm run dev
  
  # å¯åŠ¨ Celeryï¼ˆå¯é€‰ï¼‰
  celery -A config worker -l info
  celery -A config beat -l info
```

### 12.3 Demo ç¯å¢ƒ

```yaml
éƒ¨ç½²æ–¹å¼: Docker + Docker Compose

æœåŠ¡å™¨è¦æ±‚:
  CPU: 4 æ ¸
  å†…å­˜: 8 GB
  ç£ç›˜: 100 GB SSD
  æ“ä½œç³»ç»Ÿ: Ubuntu 22.04 LTS

Docker æœåŠ¡:
  - postgres:15-alpine
  - redis:7-alpine
  - backend:demo (Django)
  - frontend:demo (Next.js)
  - nginx:alpine (åå‘ä»£ç†)
  - celery-worker:demo
  - celery-beat:demo

ç¯å¢ƒå˜é‡ (Backend):
  # Django
  DJANGO_ENV=demo
  DEBUG=false
  SECRET_KEY=<secure-random-string>
  ALLOWED_HOSTS=demo.posx.io,api.demo.posx.io
  
  # Database
  DATABASE_URL=postgresql://posx:xxx@postgres:5432/posx_demo
  
  # Redis
  REDIS_URL=redis://redis:6379/0
  
  # Auth0
  AUTH0_DOMAIN=demo-xxx.auth0.com
  AUTH0_AUDIENCE=https://api.demo.posx.io
  
  # Stripe (æµ‹è¯•å¯†é’¥)
  STRIPE_SECRET_KEY=sk_test_xxx
  STRIPE_WEBHOOK_SECRET=whsec_xxx
  
  # Fireblocks (æµ‹è¯•ç¯å¢ƒ)
  FIREBLOCKS_API_KEY=xxx
  FIREBLOCKS_BASE_URL=https://sandbox-api.fireblocks.io
  
  # Sentry
  SENTRY_DSN=https://xxx@sentry.io/xxx
  SENTRY_ENVIRONMENT=demo
  
  # å…¶ä»–
  FRONTEND_URL=https://demo.posx.io
  CORS_ALLOWED_ORIGINS=https://demo.posx.io

ç¯å¢ƒå˜é‡ (Frontend):
  # Auth0
  AUTH0_BASE_URL=https://demo.posx.io
  AUTH0_ISSUER_BASE_URL=https://demo-xxx.auth0.com
  
  # API
  NEXT_PUBLIC_API_URL=https://api.demo.posx.io/api
  
  # å…¶ä»–åŒæœ¬åœ°ç¯å¢ƒ

åŸŸåé…ç½®:
  demo.posx.io â†’ Frontend
  api.demo.posx.io â†’ Backend
  
SSL è¯ä¹¦:
  æä¾›å•†: Let's Encrypt
  è‡ªåŠ¨ç»­æœŸ: Certbot

å¤‡ä»½ç­–ç•¥:
  æ•°æ®åº“: æ¯æ—¥ 1 æ¬¡ï¼ˆä¿ç•™ 7 å¤©ï¼‰
  æ–‡ä»¶: æ— éœ€å¤‡ä»½ï¼ˆå¯é‡å»ºï¼‰
```

### 12.4 ç”Ÿäº§ç¯å¢ƒ

```yaml
éƒ¨ç½²æ–¹å¼: Kubernetes (EKS/GKE/AKS)

é›†ç¾¤è§„æ¨¡:
  èŠ‚ç‚¹ç±»å‹: 
    - é€šç”¨èŠ‚ç‚¹: 2-10 ä¸ªï¼ˆè‡ªåŠ¨æ‰©å±•ï¼‰
    - æ•°æ®åº“èŠ‚ç‚¹: 2 ä¸ªï¼ˆRDS/Cloud SQLï¼‰
  èŠ‚ç‚¹è§„æ ¼:
    CPU: 4-8 æ ¸
    å†…å­˜: 16-32 GB

æœåŠ¡æ¶æ„:
  Frontend:
    ç±»å‹: Deployment
    å‰¯æœ¬æ•°: 3-10ï¼ˆè‡ªåŠ¨æ‰©å±•ï¼‰
    å®¹å™¨: node:20-alpine
    ç«¯å£: 3000
    å¥åº·æ£€æŸ¥: HTTP /_health
  
  Backend:
    ç±»å‹: Deployment
    å‰¯æœ¬æ•°: 3-10ï¼ˆè‡ªåŠ¨æ‰©å±•ï¼‰
    å®¹å™¨: python:3.11-slim
    ç«¯å£: 8000
    å¥åº·æ£€æŸ¥: HTTP /health/
  
  Celery Worker:
    ç±»å‹: Deployment
    å‰¯æœ¬æ•°: 2-5
    é˜Ÿåˆ—: default, priority, low
  
  Celery Beat:
    ç±»å‹: Deployment
    å‰¯æœ¬æ•°: 1ï¼ˆå•å®ä¾‹ï¼‰
  
  PostgreSQL:
    ç±»å‹: æ‰˜ç®¡æœåŠ¡ (RDS/Cloud SQL)
    è§„æ ¼: db.m6g.2xlarge (8 vCPU, 32 GB)
    å­˜å‚¨: 500 GB SSD
    å¤‡ä»½: è‡ªåŠ¨å¤‡ä»½ï¼ˆä¿ç•™ 30 å¤©ï¼‰
    é«˜å¯ç”¨: Multi-AZ
  
  Redis:
    ç±»å‹: æ‰˜ç®¡æœåŠ¡ (ElastiCache/MemoryStore)
    è§„æ ¼: cache.m6g.large (2 vCPU, 6.38 GB)
    æŒä¹…åŒ–: AOF
    é«˜å¯ç”¨: é›†ç¾¤æ¨¡å¼
  
  Nginx/ALB:
    ç±»å‹: LoadBalancer
    SSL: ACM Certificate
    WAF: å¯ç”¨

ç¯å¢ƒå˜é‡ (Backend):
  # Django
  DJANGO_ENV=production
  DEBUG=false
  SECRET_KEY=<ultra-secure-random-string>
  ALLOWED_HOSTS=posx.io,api.posx.io,www.posx.io
  
  # Database
  DATABASE_URL=postgresql://posx:xxx@posx-db.xxx.rds.amazonaws.com:5432/posx_prod
  
  # Redis
  REDIS_URL=redis://posx-redis.xxx.cache.amazonaws.com:6379/0
  
  # Auth0
  AUTH0_DOMAIN=posx.auth0.com
  AUTH0_AUDIENCE=https://api.posx.io
  AUTH0_ISSUER=https://posx.auth0.com/
  
  # Stripe (ç”Ÿäº§å¯†é’¥)
  STRIPE_SECRET_KEY=sk_live_xxx
  STRIPE_PUBLISHABLE_KEY=pk_live_xxx
  STRIPE_WEBHOOK_SECRET=whsec_xxx
  
  # Fireblocks (ç”Ÿäº§ç¯å¢ƒ)
  FIREBLOCKS_API_KEY=xxx
  FIREBLOCKS_PRIVATE_KEY=<encrypted-pem>
  FIREBLOCKS_BASE_URL=https://api.fireblocks.io
  FIREBLOCKS_VAULT_ACCOUNT_ID=0
  FIREBLOCKS_ASSET_ID=POSX
  FIREBLOCKS_WEBHOOK_PUBLIC_KEY=<pem-content>
  
  # Blockchain (ä¸»ç½‘)
  ETH_RPC_URL=https://mainnet.infura.io/v3/xxx
  TOKEN_CONTRACT_ADDRESS=0x...
  
  # Sentry
  SENTRY_DSN=https://xxx@sentry.io/xxx
  SENTRY_ENVIRONMENT=production
  SENTRY_TRACES_SAMPLE_RATE=0.1
  
  # AWS
  AWS_ACCESS_KEY_ID=xxx
  AWS_SECRET_ACCESS_KEY=xxx
  AWS_S3_BUCKET=posx-prod-assets
  AWS_REGION=us-east-1
  
  # å…¶ä»–
  FRONTEND_URL=https://posx.io
  CORS_ALLOWED_ORIGINS=https://posx.io,https://www.posx.io
  ALLOWED_SITE_CODES=NA,ASIA
  LOG_LEVEL=WARNING

ç¯å¢ƒå˜é‡ (Frontend):
  # Auth0
  AUTH0_BASE_URL=https://posx.io
  AUTH0_ISSUER_BASE_URL=https://posx.auth0.com
  AUTH0_CLIENT_ID=xxx
  AUTH0_CLIENT_SECRET=xxx
  AUTH0_SECRET=<ultra-secure-random-string>
  
  # API
  NEXT_PUBLIC_API_URL=https://api.posx.io/api
  
  # Stripe
  NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_xxx
  
  # WalletConnect
  NEXT_PUBLIC_WALLETCONNECT_PROJECT_ID=xxx
  
  # Blockchain
  NEXT_PUBLIC_ETH_RPC_URL=https://mainnet.infura.io/v3/xxx
  NEXT_PUBLIC_TOKEN_CONTRACT_ADDRESS=0x...
  
  # Sentry
  NEXT_PUBLIC_SENTRY_DSN=https://xxx@sentry.io/xxx
  NEXT_PUBLIC_SENTRY_ENVIRONMENT=production

åŸŸåé…ç½®:
  posx.io â†’ Frontend (ä¸»åŸŸå)
  www.posx.io â†’ Frontend (é‡å®šå‘)
  api.posx.io â†’ Backend API
  admin.posx.io â†’ Admin Backend
  
SSL è¯ä¹¦:
  æä¾›å•†: AWS ACM / Let's Encrypt
  è‡ªåŠ¨ç»­æœŸ: æ˜¯
  HTTPS å¼ºåˆ¶: æ˜¯
  HSTS: å¯ç”¨

CDN é…ç½®:
  æä¾›å•†: CloudFront / Cloudflare
  ç¼“å­˜ç­–ç•¥:
    - é™æ€èµ„æº: 1 å¹´
    - API å“åº”: ä¸ç¼“å­˜
    - HTML: 5 åˆ†é’Ÿ
  
å¤‡ä»½ç­–ç•¥:
  æ•°æ®åº“:
    - è‡ªåŠ¨å¤‡ä»½: æ¯å°æ—¶
    - æ‰‹åŠ¨å¿«ç…§: æ¯å‘¨
    - ä¿ç•™æœŸ: 30 å¤©
    - å¼‚åœ°å¤åˆ¶: å¯ç”¨
  
  Redis:
    - AOF æŒä¹…åŒ–: å¯ç”¨
    - å¿«ç…§: æ¯æ—¥
    - ä¿ç•™æœŸ: 7 å¤©

ç›‘æ§æŒ‡æ ‡:
  - CPU ä½¿ç”¨ç‡ > 80%
  - å†…å­˜ä½¿ç”¨ç‡ > 85%
  - ç£ç›˜ä½¿ç”¨ç‡ > 80%
  - API å“åº”æ—¶é—´ > 1s
  - é”™è¯¯ç‡ > 1%
  - æ•°æ®åº“è¿æ¥æ± è€—å°½
```

---

## 13. éƒ¨ç½²è§„èŒƒ

### 13.1 éƒ¨ç½²æµç¨‹

```yaml
å¼€å‘æµç¨‹:
  1. æœ¬åœ°å¼€å‘:
     - åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
     - ç¼–å†™ä»£ç  + æµ‹è¯•
     - æäº¤åˆ° Git
  
  2. ä»£ç å®¡æŸ¥:
     - åˆ›å»º Pull Request
     - å›¢é˜Ÿæˆå‘˜ Review
     - ä¿®æ”¹å¹¶é€šè¿‡å®¡æŸ¥
  
  3. åˆå¹¶ä¸»åˆ†æ”¯:
     - åˆå¹¶åˆ° main/develop
     - è‡ªåŠ¨è§¦å‘ CI/CD
  
  4. éƒ¨ç½²åˆ° Demo:
     - è‡ªåŠ¨éƒ¨ç½²åˆ° Demo ç¯å¢ƒ
     - è¿è¡Œé›†æˆæµ‹è¯•
     - UAT éªŒæ”¶æµ‹è¯•
  
  5. éƒ¨ç½²åˆ°ç”Ÿäº§:
     - æ‰‹åŠ¨è§¦å‘ç”Ÿäº§éƒ¨ç½²
     - é‡‘ä¸é›€å‘å¸ƒï¼ˆ10% â†’ 50% â†’ 100%ï¼‰
     - ç›‘æ§æŒ‡æ ‡
     - å‡ºé—®é¢˜å¿«é€Ÿå›æ»š

CI/CD å·¥å…·:
  æ¨è: GitHub Actions / GitLab CI / Jenkins
  
  Pipeline é˜¶æ®µ:
    - Lint: ä»£ç æ£€æŸ¥
    - Test: å•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯•
    - Build: æ„å»º Docker é•œåƒ
    - Push: æ¨é€åˆ°é•œåƒä»“åº“
    - Deploy: éƒ¨ç½²åˆ° K8s

éƒ¨ç½²ç­–ç•¥:
  å¼€å‘ç¯å¢ƒ: è‡ªåŠ¨éƒ¨ç½²ï¼ˆæ¯æ¬¡ commitï¼‰
  Demo ç¯å¢ƒ: è‡ªåŠ¨éƒ¨ç½²ï¼ˆmerge åˆ° developï¼‰
  ç”Ÿäº§ç¯å¢ƒ: æ‰‹åŠ¨å®¡æ‰¹ + é‡‘ä¸é›€å‘å¸ƒ
```

### 13.2 Docker é•œåƒè§„èŒƒ

```yaml
Backend Dockerfile:
  åŸºç¡€é•œåƒ: python:3.11-slim
  å·¥ä½œç›®å½•: /app
  
  æ„å»ºé˜¶æ®µ:
    1. å®‰è£…ç³»ç»Ÿä¾èµ–
    2. å¤åˆ¶ requirements.txt
    3. å®‰è£… Python ä¾èµ–
    4. å¤åˆ¶åº”ç”¨ä»£ç 
    5. æ”¶é›†é™æ€æ–‡ä»¶
    6. è®¾ç½®å¯åŠ¨å‘½ä»¤
  
  ä¼˜åŒ–:
    - ä½¿ç”¨å¤šé˜¶æ®µæ„å»º
    - ç¼“å­˜ Python ä¾èµ–å±‚
    - åˆ é™¤æ„å»ºå·¥å…·ï¼ˆå‡å°ä½“ç§¯ï¼‰
    - ä½¿ç”¨ .dockerignore
  
  å®‰å…¨:
    - é root ç”¨æˆ·è¿è¡Œ
    - æ‰«ææ¼æ´
    - å®šæœŸæ›´æ–°åŸºç¡€é•œåƒ

Frontend Dockerfile:
  åŸºç¡€é•œåƒ: node:20-alpine
  å·¥ä½œç›®å½•: /app
  
  æ„å»ºé˜¶æ®µ:
    1. å¤åˆ¶ package.json
    2. å®‰è£…ä¾èµ–
    3. å¤åˆ¶åº”ç”¨ä»£ç 
    4. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
    5. è®¾ç½®å¯åŠ¨å‘½ä»¤
  
  ä¼˜åŒ–:
    - ä½¿ç”¨å¤šé˜¶æ®µæ„å»º
    - ç¼“å­˜ node_modules å±‚
    - ä½¿ç”¨ .dockerignore
    - è¾“å‡ºä¼˜åŒ–ï¼ˆnext.config.jsï¼‰

é•œåƒæ ‡ç­¾è§„èŒƒ:
  æ ¼å¼: {registry}/{repo}:{tag}
  
  æ ‡ç­¾ç­–ç•¥:
    - latest: æœ€æ–°ç‰ˆæœ¬
    - {version}: è¯­ä¹‰åŒ–ç‰ˆæœ¬ (v1.0.0)
    - {branch}-{commit}: åˆ†æ”¯ + Commit SHA
    - {env}: ç¯å¢ƒæ ‡è¯† (demo/prod)

é•œåƒä»“åº“:
  å¼€å‘/Demo: Docker Hub / GitHub Registry
  ç”Ÿäº§: ECR / GCR / ACR (ç§æœ‰ä»“åº“)
```

### 13.3 æ•°æ®åº“è¿ç§»è§„èŒƒ

```yaml
è¿ç§»å·¥å…·: Django Migrations

è¿ç§»æµç¨‹:
  1. å¼€å‘ç¯å¢ƒåˆ›å»ºè¿ç§»:
     python manage.py makemigrations
  
  2. æœ¬åœ°æµ‹è¯•:
     python manage.py migrate
     python manage.py migrate --fake-initial (å¦‚éœ€)
  
  3. æäº¤åˆ°ç‰ˆæœ¬æ§åˆ¶:
     git add migrations/
     git commit -m "Add xxx migration"
  
  4. éƒ¨ç½²æ—¶è‡ªåŠ¨æ‰§è¡Œ:
     - Demo: è‡ªåŠ¨æ‰§è¡Œ
     - ç”Ÿäº§: éƒ¨ç½²å‰æ‰‹åŠ¨æ‰§è¡Œï¼ˆæˆ–è‡ªåŠ¨ + ç›‘æ§ï¼‰

è¿ç§»æ£€æŸ¥:
  éƒ¨ç½²å‰:
    - MUST åœ¨ Demo ç¯å¢ƒæµ‹è¯•
    - MUST éªŒè¯å›æ»šè„šæœ¬
    - SHOULD è¯„ä¼°æ‰§è¡Œæ—¶é—´
    - SHOULD è¯„ä¼°é”è¡¨å½±å“
  
  éƒ¨ç½²æ—¶:
    - MUST å¤‡ä»½æ•°æ®åº“
    - SHOULD åœ¨ç»´æŠ¤çª—å£æ‰§è¡Œï¼ˆå¤§è¿ç§»ï¼‰
    - MUST ç›‘æ§æ‰§è¡ŒçŠ¶æ€
  
  éƒ¨ç½²å:
    - MUST éªŒè¯æ•°æ®å®Œæ•´æ€§
    - MUST éªŒè¯åº”ç”¨åŠŸèƒ½
    - SHOULD æ€§èƒ½å›å½’æµ‹è¯•

å¤§è¿ç§»ç­–ç•¥:
  - åˆ†é˜¶æ®µæ‰§è¡Œï¼ˆé¿å…é•¿æ—¶é—´é”è¡¨ï¼‰
  - å…ˆæ·»åŠ åˆ—ï¼ˆå¯ç©ºï¼‰ï¼Œåå¡«å……æ•°æ®
  - ä½¿ç”¨åå°ä»»åŠ¡å¡«å……æ•°æ®
  - æœ€åè®¾ç½®éç©ºçº¦æŸ
```

---

## 14. è¿ç»´è§„èŒƒ

### 14.1 æ—¥å¿—è§„èŒƒ

```yaml
æ—¥å¿—çº§åˆ«:
  DEBUG: è°ƒè¯•ä¿¡æ¯ï¼ˆä»…å¼€å‘ç¯å¢ƒï¼‰
  INFO: ä¸€èˆ¬ä¿¡æ¯ï¼ˆä¸šåŠ¡æ“ä½œï¼‰
  WARNING: è­¦å‘Šï¼ˆå¯æ¢å¤é”™è¯¯ï¼‰
  ERROR: é”™è¯¯ï¼ˆéœ€è¦å…³æ³¨ï¼‰
  CRITICAL: ä¸¥é‡é”™è¯¯ï¼ˆéœ€è¦ç«‹å³å¤„ç†ï¼‰

æ—¥å¿—å†…å®¹:
  å¿…å«å­—æ®µ:
    - timestamp: ISO 8601 æ ¼å¼
    - level: æ—¥å¿—çº§åˆ«
    - logger: æ—¥å¿—æ¥æº
    - message: æ—¥å¿—æ¶ˆæ¯
    - request_id: è¯·æ±‚å”¯ä¸€ ID
  
  å¯é€‰å­—æ®µ:
    - user_id: ç”¨æˆ· ID
    - order_id: è®¢å• ID
    - error_code: é”™è¯¯ä»£ç 
    - stack_trace: å †æ ˆè·Ÿè¸ª
    - extra: é¢å¤–ä¿¡æ¯

æ—¥å¿—æ ¼å¼:
  å¼€å‘ç¯å¢ƒ: æ§åˆ¶å°è¾“å‡ºï¼ˆå½©è‰²ï¼‰
  ç”Ÿäº§ç¯å¢ƒ: JSON æ ¼å¼
  
  ç¤ºä¾‹:
    {
      "timestamp": "2025-11-07T14:30:00.123Z",
      "level": "ERROR",
      "logger": "apps.orders.views",
      "message": "Order creation failed",
      "request_id": "uuid",
      "user_id": "uuid",
      "error_code": "ORDER_INSUFFICIENT_STOCK",
      "extra": {
        "tier_id": "uuid",
        "requested_quantity": 10,
        "available_quantity": 5
      }
    }

æ—¥å¿—å­˜å‚¨:
  å¼€å‘ç¯å¢ƒ: æœ¬åœ°æ–‡ä»¶
  Demo ç¯å¢ƒ: CloudWatch / æ–‡ä»¶
  ç”Ÿäº§ç¯å¢ƒ: CloudWatch / ELK Stack
  
  ä¿ç•™æœŸé™:
    - DEBUG: 1 å¤©
    - INFO: 30 å¤©
    - WARNING: 90 å¤©
    - ERROR/CRITICAL: 1 å¹´

æ—¥å¿—å®‰å…¨:
  - MUST_NOT è®°å½•å¯†ç 
  - MUST_NOT è®°å½•å®Œæ•´ä¿¡ç”¨å¡å·
  - MUST_NOT è®°å½•ç§é’¥
  - SHOULD è„±æ•æ•æ„Ÿä¿¡æ¯
```

### 14.2 ç›‘æ§è§„èŒƒ

```yaml
ç›‘æ§å·¥å…·:
  åº”ç”¨ç›‘æ§: Sentry / New Relic
  åŸºç¡€è®¾æ–½ç›‘æ§: CloudWatch / Prometheus
  æ—¥å¿—åˆ†æ: ELK Stack / CloudWatch Logs
  å®æ—¶ç›‘æ§: Grafana

ç›‘æ§æŒ‡æ ‡:
  ç³»ç»ŸæŒ‡æ ‡:
    - CPU ä½¿ç”¨ç‡
    - å†…å­˜ä½¿ç”¨ç‡
    - ç£ç›˜ä½¿ç”¨ç‡
    - ç½‘ç»œæµé‡
    - ç£ç›˜ I/O
  
  åº”ç”¨æŒ‡æ ‡:
    - è¯·æ±‚é€Ÿç‡ (RPS)
    - å“åº”æ—¶é—´ (P50/P95/P99)
    - é”™è¯¯ç‡
    - æ•°æ®åº“è¿æ¥æ± ä½¿ç”¨ç‡
    - ç¼“å­˜å‘½ä¸­ç‡
    - é˜Ÿåˆ—é•¿åº¦
  
  ä¸šåŠ¡æŒ‡æ ‡:
    - è®¢å•åˆ›å»ºé€Ÿç‡
    - æ”¯ä»˜æˆåŠŸç‡
    - ä»£å¸å‘æ”¾é€Ÿç‡
    - æ³¨å†Œç”¨æˆ·æ•°
    - æ´»è·ƒç”¨æˆ·æ•°

å¥åº·æ£€æŸ¥:
  Backend:
    è·¯å¾„: /health/
    æ£€æŸ¥å†…å®¹:
      - æ•°æ®åº“è¿æ¥
      - Redis è¿æ¥
      - ç£ç›˜ç©ºé—´
    å“åº”æ ¼å¼:
      {
        "status": "healthy",
        "checks": {
          "database": "ok",
          "redis": "ok",
          "disk": "ok"
        },
        "timestamp": "2025-11-07T14:30:00Z"
      }
  
  Frontend:
    è·¯å¾„: /_health
    æ£€æŸ¥å†…å®¹: åº”ç”¨è¿è¡ŒçŠ¶æ€
    å“åº”: 200 OK

å‘Šè­¦è§¦å‘:
  - é”™è¯¯ç‡ > 1%ï¼ˆ5 åˆ†é’Ÿï¼‰
  - API å“åº”æ—¶é—´ P95 > 2s
  - CPU ä½¿ç”¨ç‡ > 80%ï¼ˆ10 åˆ†é’Ÿï¼‰
  - å†…å­˜ä½¿ç”¨ç‡ > 85%
  - ç£ç›˜ä½¿ç”¨ç‡ > 80%
  - æ•°æ®åº“è¿æ¥æ± è€—å°½
  - Redis è¿æ¥å¤±è´¥
  - æ”¯ä»˜å¤±è´¥ç‡ > 5%
```

### 14.3 å®šæ—¶ä»»åŠ¡è§„èŒƒ

```yaml
ä»»åŠ¡è°ƒåº¦: Celery Beat

ä»»åŠ¡åˆ—è¡¨:
  1. è®¢å•è¿‡æœŸå–æ¶ˆ:
     å‘¨æœŸ: æ¯ 5 åˆ†é’Ÿ
     ä»»åŠ¡: cancel_expired_orders
     ä½œç”¨: å–æ¶ˆè¶…æ—¶æœªæ”¯ä»˜è®¢å•
  
  2. ä½£é‡‘å†»ç»“æœŸé‡Šæ”¾:
     å‘¨æœŸ: æ¯å°æ—¶
     ä»»åŠ¡: release_held_commissions
     ä½œç”¨: è§£å†»åˆ°æœŸä½£é‡‘
  
  3. æ¸…ç†å¹‚ç­‰é”®:
     å‘¨æœŸ: æ¯å¤© 3:00
     ä»»åŠ¡: cleanup_idempotency_keys
     ä½œç”¨: åˆ é™¤ 48 å°æ—¶å‰çš„å¹‚ç­‰é”®
  
  4. æ¸…ç†è¿‡æœŸ Nonce:
     å‘¨æœŸ: æ¯å°æ—¶
     ä»»åŠ¡: cleanup_expired_nonces
     ä½œç”¨: åˆ é™¤è¿‡æœŸ Nonce
  
  5. åŒæ­¥ Fireblocks ä½™é¢:
     å‘¨æœŸ: æ¯ 10 åˆ†é’Ÿ
     ä»»åŠ¡: sync_fireblocks_balances
     ä½œç”¨: åŒæ­¥ç”¨æˆ·ä»£å¸ä½™é¢
  
  6. æ•°æ®åº“å¤‡ä»½éªŒè¯:
     å‘¨æœŸ: æ¯å¤© 2:00
     ä»»åŠ¡: verify_database_backup
     ä½œç”¨: éªŒè¯å¤‡ä»½å¯ç”¨æ€§
  
  7. ç”Ÿæˆæ—¥æŠ¥:
     å‘¨æœŸ: æ¯å¤© 8:00
     ä»»åŠ¡: generate_daily_report
     ä½œç”¨: ç”Ÿæˆè¿è¥æ—¥æŠ¥

ä»»åŠ¡é…ç½®:
  é‡è¯•ç­–ç•¥:
    - æœ€å¤§é‡è¯•æ¬¡æ•°: 3
    - é‡è¯•å»¶è¿Ÿ: æŒ‡æ•°é€€é¿ (60s, 120s, 240s)
    - å¤±è´¥å‘Šè­¦: Sentry
  
  è¶…æ—¶é…ç½®:
    - è½¯è¶…æ—¶: 300 ç§’
    - ç¡¬è¶…æ—¶: 600 ç§’
  
  å¹¶å‘æ§åˆ¶:
    - é˜Ÿåˆ—éš”ç¦»ï¼ˆdefault/priority/lowï¼‰
    - é™æµï¼ˆé¿å…å‹å®æ•°æ®åº“ï¼‰

ç›‘æ§å‘Šè­¦:
  - ä»»åŠ¡æ‰§è¡Œå¤±è´¥
  - ä»»åŠ¡æ‰§è¡Œè¶…æ—¶
  - ä»»åŠ¡é˜Ÿåˆ—å †ç§¯
  - Celery Worker å®•æœº
```

---

## 15. ç›‘æ§ä¸å‘Šè­¦è§„èŒƒ

### 15.1 å‘Šè­¦è§„åˆ™

```yaml
å‘Šè­¦çº§åˆ«:
  P0 - Critical:
    å½±å“: æ ¸å¿ƒåŠŸèƒ½ä¸å¯ç”¨
    å“åº”æ—¶é—´: 15 åˆ†é’Ÿ
    é€šçŸ¥æ–¹å¼: ç”µè¯ + çŸ­ä¿¡ + Slack
    ç¤ºä¾‹:
      - æ•°æ®åº“å®•æœº
      - æ‰€æœ‰ API ä¸å¯ç”¨
      - æ”¯ä»˜ç³»ç»Ÿæ•…éšœ
  
  P1 - High:
    å½±å“: é‡è¦åŠŸèƒ½å—å½±å“
    å“åº”æ—¶é—´: 1 å°æ—¶
    é€šçŸ¥æ–¹å¼: Slack + Email
    ç¤ºä¾‹:
      - é”™è¯¯ç‡ > 5%
      - API å“åº”æ—¶é—´ > 5s
      - Celery Worker å…¨éƒ¨å®•æœº
  
  P2 - Medium:
    å½±å“: éƒ¨åˆ†åŠŸèƒ½å—å½±å“
    å“åº”æ—¶é—´: 4 å°æ—¶
    é€šçŸ¥æ–¹å¼: Slack
    ç¤ºä¾‹:
      - é”™è¯¯ç‡ > 1%
      - CPU ä½¿ç”¨ç‡ > 80%
      - é˜Ÿåˆ—å †ç§¯
  
  P3 - Low:
    å½±å“: å¯å¿½ç•¥
    å“åº”æ—¶é—´: 1 ä¸ªå·¥ä½œæ—¥
    é€šçŸ¥æ–¹å¼: Email
    ç¤ºä¾‹:
      - ç£ç›˜ä½¿ç”¨ç‡ > 70%
      - ç¼“å­˜å‘½ä¸­ç‡ < 80%

å‘Šè­¦è§„åˆ™:
  æ•°æ®åº“:
    - è¿æ¥æ•° > 80% (P2)
    - æ…¢æŸ¥è¯¢ > 100/min (P2)
    - å¤åˆ¶å»¶è¿Ÿ > 60s (P1)
    - ç£ç›˜ä½¿ç”¨ç‡ > 80% (P2)
  
  API:
    - é”™è¯¯ç‡ > 1% (P2)
    - é”™è¯¯ç‡ > 5% (P1)
    - å“åº”æ—¶é—´ P95 > 2s (P2)
    - å“åº”æ—¶é—´ P95 > 5s (P1)
    - æ‰€æœ‰è¯·æ±‚å¤±è´¥ (P0)
  
  æ”¯ä»˜:
    - Stripe Webhook å¤±è´¥ç‡ > 5% (P1)
    - æ”¯ä»˜æˆåŠŸç‡ < 95% (P1)
    - äº‰è®®åˆ›å»º (P2)
  
  ä»£å¸åˆ†é…:
    - Fireblocks Webhook å¤±è´¥ç‡ > 5% (P1)
    - å‘æ”¾å¤±è´¥ç‡ > 10% (P2)
  
  é˜Ÿåˆ—:
    - é˜Ÿåˆ—é•¿åº¦ > 1000 (P2)
    - é˜Ÿåˆ—é•¿åº¦ > 10000 (P1)
    - Worker å…¨éƒ¨å®•æœº (P1)

å‘Šè­¦æŠ‘åˆ¶:
  - ç»´æŠ¤çª—å£æœŸé—´é™éŸ³
  - å·²çŸ¥é—®é¢˜æ ‡è®°ï¼ˆé¿å…é‡å¤å‘Šè­¦ï¼‰
  - å‘Šè­¦èšåˆï¼ˆ5 åˆ†é’Ÿå†…ç›¸åŒå‘Šè­¦åˆå¹¶ï¼‰
```

### 15.2 äº‹ä»¶å“åº”

```yaml
å“åº”æµç¨‹:
  1. æ¥æ”¶å‘Šè­¦:
     - é€šè¿‡ Slack / PagerDuty æ¥æ”¶
     - ç¡®è®¤å‘Šè­¦ï¼ˆACKï¼‰
  
  2. åˆæ­¥è¯Šæ–­:
     - æŸ¥çœ‹ç›‘æ§é¢æ¿
     - æŸ¥çœ‹æ—¥å¿—
     - ç¡®å®šå½±å“èŒƒå›´
  
  3. åº”æ€¥å¤„ç†:
     - P0: ç«‹å³å›æ»šæˆ–åˆ‡æ¢å¤‡ç”¨
     - P1: å°è¯•ä¿®å¤æˆ–é™çº§
     - P2: è®¡åˆ’ä¿®å¤
  
  4. æ ¹å› åˆ†æ:
     - æŸ¥æ‰¾æ ¹æœ¬åŸå› 
     - ç¼–å†™äº‹æ•…æŠ¥å‘Š
  
  5. æ”¹è¿›æªæ–½:
     - ä¿®å¤ Bug
     - æ”¹è¿›ç›‘æ§
     - æ›´æ–° Runbook

å¸¸è§é—®é¢˜ Runbook:
  æ•°æ®åº“è¿æ¥æ± è€—å°½:
    è¯Šæ–­:
      - æ£€æŸ¥è¿æ¥æ•°: SELECT count(*) FROM pg_stat_activity
      - æ£€æŸ¥é•¿äº‹åŠ¡: SELECT * FROM pg_stat_activity WHERE state = 'active' AND query_start < now() - interval '5 minutes'
    å¤„ç†:
      - æ€æ­»é•¿äº‹åŠ¡
      - é‡å¯åº”ç”¨ï¼ˆé‡Šæ”¾è¿æ¥ï¼‰
      - å¢åŠ è¿æ¥æ± å¤§å°ï¼ˆå¦‚éœ€ï¼‰
  
  è®¢å•è¶…å–:
    è¯Šæ–­:
      - æ£€æŸ¥ tier.sold_units > tier.total_units
      - æ£€æŸ¥å¹¶å‘è®¢å•æ—¥å¿—
    å¤„ç†:
      - å›æ»šè¶…å–è®¢å•
      - é€€æ¬¾ç»™ç”¨æˆ·
      - ä¿®å¤å¹¶å‘æ§åˆ¶ Bug
  
  Webhook å¤„ç†å¤±è´¥:
    è¯Šæ–­:
      - æ£€æŸ¥ webhook_logs è¡¨
      - æ£€æŸ¥ Celery é˜Ÿåˆ—
      - æ£€æŸ¥é”™è¯¯æ—¥å¿—
    å¤„ç†:
      - é‡è¯•å¤±è´¥çš„ Webhook
      - ä¿®å¤å¤„ç†é€»è¾‘
      - è”ç³»ç¬¬ä¸‰æ–¹ï¼ˆå¦‚æŒç»­å¤±è´¥ï¼‰
```

---

## 16. æœ¯è¯­è¡¨

```yaml
æ ¸å¿ƒæœ¯è¯­:
  Site: ç«™ç‚¹ï¼Œç‹¬ç«‹è¿è¥çš„åŒºåŸŸï¼ˆå¦‚ NA, ASIAï¼‰
  Tier: æ¡£ä½ï¼Œä¸åŒä»·æ ¼å’Œä»£å¸æ•°é‡çš„è´­ä¹°é€‰é¡¹
  Order: è®¢å•ï¼Œç”¨æˆ·è´­ä¹°ä»£å¸çš„è®°å½•
  Allocation: åˆ†é…ï¼Œä»£å¸å‘æ”¾è®°å½•
  Commission: ä½£é‡‘ï¼Œæ¨èå¥–åŠ±
  Wallet: é’±åŒ…ï¼Œç”¨æˆ·æ¥æ”¶ä»£å¸çš„åœ°å€
  Nonce: ä¸€æ¬¡æ€§éšæœºæ•°ï¼Œç”¨äºé˜²é‡æ”¾æ”»å‡»

çŠ¶æ€æœ¯è¯­:
  Pending: å¾…å¤„ç†
  Processing: å¤„ç†ä¸­
  Completed: å·²å®Œæˆ
  Failed: å¤±è´¥
  Cancelled: å·²å–æ¶ˆ
  Hold: å†»ç»“
  Ready: å°±ç»ª
  Paid: å·²æ”¯ä»˜
  Disputed: æœ‰äº‰è®®

æŠ€æœ¯æœ¯è¯­:
  Idempotency: å¹‚ç­‰æ€§ï¼Œç›¸åŒè¯·æ±‚äº§ç”Ÿç›¸åŒç»“æœ
  Optimistic Lock: ä¹è§‚é”ï¼Œé€šè¿‡ç‰ˆæœ¬å·æ§åˆ¶å¹¶å‘
  Webhook: Web å›è°ƒï¼Œç¬¬ä¸‰æ–¹æœåŠ¡äº‹ä»¶é€šçŸ¥
  JWT: JSON Web Tokenï¼Œèº«ä»½è®¤è¯ä»¤ç‰Œ
  RSA: éå¯¹ç§°åŠ å¯†ç®—æ³•
  HMAC: åŸºäºå“ˆå¸Œçš„æ¶ˆæ¯è®¤è¯ç 
  SIWE: Sign-In with Ethereumï¼Œä»¥å¤ªåŠé’±åŒ…ç™»å½•
  RBAC: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶

ç¬¬ä¸‰æ–¹æœåŠ¡:
  Auth0: èº«ä»½è®¤è¯æœåŠ¡
  Stripe: æ”¯ä»˜å¤„ç†æœåŠ¡
  Fireblocks: æ•°å­—èµ„äº§æ‰˜ç®¡æœåŠ¡
  WalletConnect: Web3 é’±åŒ…è¿æ¥åè®®
  Sentry: é”™è¯¯ç›‘æ§æœåŠ¡

ç¼©å†™:
  API: Application Programming Interface
  REST: Representational State Transfer
  JWT: JSON Web Token
  UUID: Universally Unique Identifier
  CSRF: Cross-Site Request Forgery
  XSS: Cross-Site Scripting
  SQL: Structured Query Language
  ORM: Object-Relational Mapping
  CI/CD: Continuous Integration/Continuous Deployment
  K8s: Kubernetes
  RPS: Requests Per Second
  P50/P95/P99: ç™¾åˆ†ä½æ•°ï¼ˆä¸­ä½æ•°/95åˆ†ä½/99åˆ†ä½ï¼‰
```

---

## é™„å½• A: ä¸Šçº¿å‰æ£€æŸ¥æ¸…å•

```yaml
æ•°æ®åº“æ£€æŸ¥:
  [ ] æ‰€æœ‰è¿ç§»è„šæœ¬å·²æ‰§è¡Œ
  [ ] æ‰€æœ‰ç´¢å¼•å·²åˆ›å»º
  [ ] æ‰€æœ‰çº¦æŸå·²åˆ›å»º
  [ ] æ‰€æœ‰è§¦å‘å™¨å·²åˆ›å»º
  [ ] æ•°æ®åº“å¤‡ä»½å·²é…ç½®
  [ ] å¤‡ä»½æ¢å¤å·²æµ‹è¯•

ç¯å¢ƒå˜é‡æ£€æŸ¥:
  [ ] æ‰€æœ‰ç¯å¢ƒå˜é‡å·²é…ç½®
  [ ] ç”Ÿäº§å¯†é’¥å·²æ›¿æ¢ï¼ˆä¸æ˜¯æµ‹è¯•å¯†é’¥ï¼‰
  [ ] æ•æ„Ÿä¿¡æ¯å·²åŠ å¯†
  [ ] Auth0 é…ç½®æ­£ç¡®
  [ ] Stripe ç”Ÿäº§å¯†é’¥é…ç½®
  [ ] Fireblocks ç”Ÿäº§é…ç½®

ç¬¬ä¸‰æ–¹é›†æˆæ£€æŸ¥:
  [ ] Auth0 åº”ç”¨é…ç½®å®Œæˆ
  [ ] Stripe Webhook å·²è®¢é˜…
  [ ] Fireblocks Webhook å·²é…ç½®
  [ ] WalletConnect Project å·²åˆ›å»º
  [ ] Sentry é¡¹ç›®å·²åˆ›å»º

åŠŸèƒ½æµ‹è¯•:
  [ ] ç”¨æˆ·æ³¨å†Œç™»å½•ï¼ˆ3 ç§æ–¹å¼ï¼‰
  [ ] é’±åŒ…ç»‘å®š/è§£ç»‘
  [ ] æ¡£ä½æµè§ˆ
  [ ] è®¢å•åˆ›å»º
  [ ] Stripe æ”¯ä»˜
  [ ] Webhook å¤„ç†
  [ ] ä»£å¸ä½™é¢æŸ¥è¯¢
  [ ] ä½£é‡‘ç”Ÿæˆ
  [ ] ç®¡ç†åå°åŠŸèƒ½

æ€§èƒ½æµ‹è¯•:
  [ ] å¹¶å‘è®¢å•æµ‹è¯•ï¼ˆ1000+ å¹¶å‘ï¼‰
  [ ] åº“å­˜æ§åˆ¶æµ‹è¯•
  [ ] API å“åº”æ—¶é—´æµ‹è¯•
  [ ] æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
  [ ] ç¼“å­˜å‘½ä¸­ç‡æµ‹è¯•

å®‰å…¨æµ‹è¯•:
  [ ] SQL æ³¨å…¥æµ‹è¯•
  [ ] XSS æ”»å‡»æµ‹è¯•
  [ ] CSRF æ”»å‡»æµ‹è¯•
  [ ] JWT éªŒè¯æµ‹è¯•
  [ ] æƒé™æ§åˆ¶æµ‹è¯•
  [ ] é™æµæµ‹è¯•
  [ ] Webhook ç­¾åéªŒè¯

ç›‘æ§å‘Šè­¦:
  [ ] Sentry é›†æˆæµ‹è¯•
  [ ] CloudWatch å‘Šè­¦é…ç½®
  [ ] Slack å‘Šè­¦é€šçŸ¥æµ‹è¯•
  [ ] å¥åº·æ£€æŸ¥é…ç½®
  [ ] æ—¥å¿—æ”¶é›†é…ç½®

éƒ¨ç½²å‡†å¤‡:
  [ ] Docker é•œåƒå·²æ„å»º
  [ ] K8s é…ç½®å·²å‡†å¤‡
  [ ] åŸŸå DNS å·²é…ç½®
  [ ] SSL è¯ä¹¦å·²é…ç½®
  [ ] CDN å·²é…ç½®
  [ ] è´Ÿè½½å‡è¡¡å·²é…ç½®

è¿ç»´å‡†å¤‡:
  [ ] Runbook å·²ç¼–å†™
  [ ] å›¢é˜ŸåŸ¹è®­å·²å®Œæˆ
  [ ] å›æ»šè®¡åˆ’å·²å‡†å¤‡
  [ ] å®¢æœå›¢é˜Ÿå·²åŸ¹è®­
  [ ] ç›‘æ§é¢æ¿å·²é…ç½®
```

---

## é™„å½• B: ç‰ˆæœ¬è§„èŒƒ

```yaml
ç‰ˆæœ¬å·æ ¼å¼: MAJOR.MINOR.PATCH

é€’å¢è§„åˆ™:
  MAJOR: ä¸å…¼å®¹çš„ API å˜æ›´
  MINOR: å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ–°å¢
  PATCH: å‘ä¸‹å…¼å®¹çš„ Bug ä¿®å¤

ç¤ºä¾‹:
  v1.0.0: åˆå§‹ç‰ˆæœ¬
  v1.0.1: Bug ä¿®å¤
  v1.1.0: æ–°å¢åŠŸèƒ½
  v2.0.0: ç ´åæ€§å˜æ›´

Git Tag:
  æ ¼å¼: v{version}
  ç¤ºä¾‹: v1.0.0, v1.1.0

Release Notes:
  å¿…å«å†…å®¹:
    - ç‰ˆæœ¬å·
    - å‘å¸ƒæ—¥æœŸ
    - æ–°å¢åŠŸèƒ½
    - Bug ä¿®å¤
    - ç ´åæ€§å˜æ›´
    - å‡çº§æŒ‡å—
```

---

## æ–‡æ¡£ç»´æŠ¤

```yaml
æ›´æ–°é¢‘ç‡:
  - é‡å¤§å˜æ›´: ç«‹å³æ›´æ–°
  - åŠŸèƒ½æ–°å¢: æ¯æ¬¡å‘ç‰ˆæ›´æ–°
  - Bug ä¿®å¤: å­£åº¦æ±‡æ€»

å®¡æ ¸æµç¨‹:
  - æŠ€æœ¯è´Ÿè´£äººå®¡æ ¸
  - æ¶æ„å¸ˆå®¡æ ¸
  - æ–‡æ¡£å½’æ¡£

ç‰ˆæœ¬æ§åˆ¶:
  - æ‰€æœ‰å˜æ›´è®°å½•åœ¨ç‰ˆæœ¬å†å²
  - é‡å¤§å˜æ›´éœ€è¦è¯´æ˜ç†ç”±
  - ä¿ç•™å†å²ç‰ˆæœ¬ï¼ˆè‡³å°‘ 3 ä¸ªï¼‰
```

---

**æ–‡æ¡£ç»“æŸ**

**ç‰ˆæœ¬ï¼š** v1.0.0  
**å‘å¸ƒæ—¥æœŸï¼š** 2025-11-07  
**ä¸‹æ¬¡å®¡æŸ¥æ—¥æœŸï¼š** 2025-12-07  
**ç»´æŠ¤è€…ï¼š** System Architect Team
